---
title: "Plots of muscle fiber type percentages"
author: Tyler Sagendorf
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  rmarkdown::html_document:
    code_folding: hide
    toc: true
    toc_depth: 2
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 1.6,
  fig.height = 2,
  out.height = "30%",
  out.width = "30%",
  dpi = 500,
  message = FALSE,
  warning = FALSE
)

save_plots <- dir.exists(paths = file.path("..", "..", "plots"))
```

```{r setup}
# Required packages
library(MotrpacRatTrainingPhysiologyData)
library(dplyr)
library(ggplot2)
library(tidyr)
library(purrr)
```

```{r}
# Create and save all 16 plots
foo <- FIBER_TYPES %>% 
  nest(.by = c(age, sex, muscle)) %>% 
  mutate(plots = map(.x = data, .f = fiber_donut_chart),
         file_name = file.path("..", "..", "plots",
                               sprintf("fiber_count_%s_%s_%s.pdf", 
                                       muscle, age, tolower(sex))))
```

```{r eval=save_plots, results='hide'}
map2(.x = foo$file_name, .y = foo$plots, 
     .f = ~ ggsave(filename = .x, plot = .y, 
                   height = 2, width = 1.3,
                   family = "ArialMT"))

# Save panel with a legend
ggsave(filename = file.path("..", "..", "plots",
                            "fiber_count_example_with_legend.pdf"),
       plot = foo$plots[[1]] + theme(legend.position = "right"),
       height = 2, width = 1.6, family = "ArialMT")
```


# 6M Female

## LG

```{r}
foo %>% 
  filter(age == "6M", sex == "Female", muscle == "LG") %>%
  pull(plots) %>% 
  .[[1]] +
  theme(legend.position = "right")
```

## MG

```{r}
foo %>% 
  filter(age == "6M", sex == "Female", muscle == "MG") %>% 
  pull(plots) %>% 
  .[[1]] +
  theme(legend.position = "right")
```

## PL

```{r}
foo %>% 
  filter(age == "6M", sex == "Female", muscle == "PL") %>% 
  pull(plots) %>% 
  .[[1]] +
  theme(legend.position = "right")
```

## SOL

```{r}
foo %>% 
  filter(age == "6M", sex == "Female", muscle == "SOL") %>% 
  pull(plots) %>% 
  .[[1]] +
  theme(legend.position = "right")
```


# 6M Male

## LG

```{r}
foo %>% 
  filter(age == "6M", sex == "Male", muscle == "LG") %>% 
  pull(plots) %>% 
  .[[1]] +
  theme(legend.position = "right")
```

## MG

```{r}
foo %>% 
  filter(age == "6M", sex == "Male", muscle == "MG") %>% 
  pull(plots) %>% 
  .[[1]] +
  theme(legend.position = "right")
```

## PL

```{r}
foo %>% 
  filter(age == "6M", sex == "Male", muscle == "PL") %>% 
  pull(plots) %>% 
  .[[1]] +
  theme(legend.position = "right")
```

## SOL

```{r}
foo %>% 
  filter(age == "6M", sex == "Male", muscle == "SOL") %>% 
  pull(plots) %>% 
  .[[1]] +
  theme(legend.position = "right")
```


# 18M Female

## LG

```{r}
foo %>% 
  filter(age == "18M", sex == "Female", muscle == "LG") %>% 
  pull(plots) %>% 
  .[[1]] +
  theme(legend.position = "right")
```

## MG

```{r}
foo %>% 
  filter(age == "18M", sex == "Female", muscle == "MG") %>% 
  pull(plots) %>% 
  .[[1]] +
  theme(legend.position = "right")
```

## PL

```{r}
foo %>% 
  filter(age == "18M", sex == "Female", muscle == "PL") %>% 
  pull(plots) %>% 
  .[[1]] +
  theme(legend.position = "right")
```

## SOL

```{r}
foo %>% 
  filter(age == "18M", sex == "Female", muscle == "SOL") %>% 
  pull(plots) %>% 
  .[[1]] +
  theme(legend.position = "right")
```


# 18M Male

## LG

```{r}
foo %>% 
  filter(age == "18M", sex == "Male", muscle == "LG") %>% 
  pull(plots) %>% 
  .[[1]] +
  theme(legend.position = "right")
```

## MG

```{r}
foo %>% 
  filter(age == "18M", sex == "Male", muscle == "MG") %>% 
  pull(plots) %>% 
  .[[1]] +
  theme(legend.position = "right")
```

## PL

```{r}
foo %>% 
  filter(age == "18M", sex == "Male", muscle == "PL") %>% 
  pull(plots) %>% 
  .[[1]] +
  theme(legend.position = "right")
```

## SOL

```{r}
foo %>% 
  filter(age == "18M", sex == "Male", muscle == "SOL") %>% 
  pull(plots) %>% 
  .[[1]] +
  theme(legend.position = "right")
```


# Session Info

```{r}
sessionInfo()
```

