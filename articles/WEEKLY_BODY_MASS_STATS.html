<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Statistical analysis of weekly body mass • MotrpacRatTrainingPhysiologyData</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Statistical analysis of weekly body mass">
<meta property="og:description" content="MotrpacRatTrainingPhysiologyData">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MotrpacRatTrainingPhysiologyData</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ANALYTES_STATS.html">Statistical analyses of plasma clinical analytes</a>
    </li>
    <li>
      <a href="../articles/BASELINE_STATS.html">Statistical analyses of baseline body composition and VO2max testing measures</a>
    </li>
    <li>
      <a href="../articles/FIBER_AREA_STATS.html">Statistical analysis of mean fiber area by muscle and fiber type</a>
    </li>
    <li>
      <a href="../articles/FIBER_COUNT_STATS.html">Statistical analysis of fiber counts by muscle and fiber type</a>
    </li>
    <li>
      <a href="../articles/MUSCLES_STATS.html">Statistical analyses of muscle-specific measures</a>
    </li>
    <li>
      <a href="../articles/PRE_POST_STATS.html">Statistical analyses of post- vs. pre-training body composition and VO2max testing measures</a>
    </li>
    <li>
      <a href="../articles/WEEKLY_BODY_MASS_STATS.html">Statistical analysis of weekly body mass</a>
    </li>
    <li>
      <a href="../articles/analyte_plots.html">Plots of plasma clinical analytes</a>
    </li>
    <li>
      <a href="../articles/baseline_plots.html">Plots of baseline body composition and VO2max testing measures</a>
    </li>
    <li>
      <a href="../articles/dissection_time_plots.html">Plots of tissue dissection times</a>
    </li>
    <li>
      <a href="../articles/fiber_area_plots.html">Plots of fiber area by muscle and fiber type</a>
    </li>
    <li>
      <a href="../articles/fiber_count_plots.html">Plots of muscle fiber type percentages</a>
    </li>
    <li>
      <a href="../articles/muscle_plots.html">Plots of muscle-specific measures</a>
    </li>
    <li>
      <a href="../articles/pre_post_plots.html">Plots of post- vs. pre-training body composition and VO2max testing measures</a>
    </li>
    <li>
      <a href="../articles/weekly_measures_plots.html">Plots of weekly body mass and blood lactate</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MoTrPAC/MotrpacRatTrainingPhysiologyData/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Statistical analysis of weekly body mass</h1>
                        <h4 data-toc-skip class="author">Tyler
Sagendorf</h4>
            
            <h4 data-toc-skip class="date">19 January, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTrainingPhysiologyData/blob/HEAD/vignettes/WEEKLY_BODY_MASS_STATS.Rmd" class="external-link"><code>vignettes/WEEKLY_BODY_MASS_STATS.Rmd</code></a></small>
      <div class="hidden name"><code>WEEKLY_BODY_MASS_STATS.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MoTrPAC/MotrpacRatTrainingPhysiologyData/" class="external-link">MotrpacRatTrainingPhysiologyData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="external-link">nlme</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/emmeans" class="external-link">emmeans</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stefanom.io/latex2exp/" class="external-link">latex2exp</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># base plot theme</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Function to plot gls and nlme results</span></span>
<span><span class="va">plot_lme</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">standard_resid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="st">"pearson"</span>, scaled<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># Residuals vs. fitted with loess curve</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">standard_resid</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Fitted Values"</span>, ylab <span class="op">=</span> <span class="st">"Standardized Pearson Residuals"</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"Residuals vs. Fitted"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/scatter.smooth.html" class="external-link">loess.smooth</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>,</span>
<span>                     y <span class="op">=</span> <span class="va">standard_resid</span>, degree <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">## Q-Q plot</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqnorm</a></span><span class="op">(</span><span class="va">standard_resid</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqline</a></span><span class="op">(</span><span class="va">standard_resid</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>For each rat in the SED, 1W, 4W, and 8W groups, body mass (g) was
measured at the start of weeks 1 through 7. That is, the measurement at
week 1 was before the training protocol began, and the measurement at
week 2 was after rats had been placed on the treadmills at a speed of 0
m/min for 15 min/day for 5 consecutive days (SED) or at a speed and
duration determined by the training protocol for 5 consecutive days (1W,
2W, 4W, 8W). Therefore, we can reasonably assume that factors other than
whether the rats received the training intervention were the same from
week to week. This allows us to compare 8W-trained to SED animals at
each week, which are the only two groups that we will focus on in this
vignette.</p>
<p>Since we are dealing with longitudinal data (each rat has a total of
8 measurements taken across time), we need to account for the lack of
independence in the residuals for each rat. It is reasonable to assume
that the body mass of a rat at any given week is influenced by the mass
of the same rat at the previous week. That is, we do not expect a rat to
weigh 400 grams if it only weighed 300 grams the previous week.
Moreover, the body mass of any given rat does not influence the mass of
another rat. This correlation structure corresponds to an
auto-regressive process of order 1 (AR1) for each rat. We will use the
<code><a href="https://rdrr.io/pkg/nlme/man/gls.html" class="external-link">nlme::gls</a></code> function to fit a generalized least squares (GLS)
model with this correlation structure.</p>
<p><strong>Note:</strong> While we create plots for weekly measures of
blood lactate in the “Plots of weekly total body mass and blood lactate”
article, we do not perform any statistical analyses of lactate.</p>
<p>We will begin by modifying the data. Since we are only analyzing the
body mass data, we will remove any rows with missing body masses. Also,
since measures were made prior to the start of the week, we will
subtract 1 from week to convert it to the number of weeks since the
protocol began. For me, at least, this is easier to understand. This
shift will only affect the week labels in the plots. We also create a
categorical version of week (<code>fweek</code>) to be used in the GLS
model formula, while the numeric version (<code>week</code>) is used to
specify the correlation structure, since we need to preserve the order
in the longitudinal data (this is lost in the categorical version of
week).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">WEEKLY_MEASURES</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SED"</span>, <span class="st">"8W"</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">body_mass</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>week <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">week</span>, levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.dataframe.html" class="external-link">print.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        pid iowa_id omics_analysis    sex group age day week week_time body_mass</span></span>
<span><span class="co">#&gt; 1 10043527  06F8T1           TRUE Female   SED  6M   1    1     start       181</span></span>
<span><span class="co">#&gt; 2 10043799  06F8T3          FALSE Female   SED  6M   1    1     start       182</span></span>
<span><span class="co">#&gt; 3 10043950  06F8T4           TRUE Female   SED  6M   1    1     start       176</span></span>
<span><span class="co">#&gt; 4 10044094  06F8T5          FALSE Female   SED  6M   1    1     start       182</span></span>
<span><span class="co">#&gt; 5 10044337  06F8T8           TRUE Female   SED  6M   1    1     start       187</span></span>
<span><span class="co">#&gt; 6 10044418  06F8T9          FALSE Female   SED  6M   1    1     start       179</span></span>
<span><span class="co">#&gt;   lactate</span></span>
<span><span class="co">#&gt; 1      NA</span></span>
<span><span class="co">#&gt; 2      NA</span></span>
<span><span class="co">#&gt; 3      NA</span></span>
<span><span class="co">#&gt; 4      NA</span></span>
<span><span class="co">#&gt; 5      NA</span></span>
<span><span class="co">#&gt; 6      NA</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">week</span>, y <span class="op">=</span> <span class="va">body_mass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">pid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">group</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span></code></pre></div>
<p><img src="WEEKLY_BODY_MASS_STATS_files/figure-html/unnamed-chunk-4-1.png" width="2400"></p>
<p>While individual variation is apparent, there appear to be overall
trends in the different panels.</p>
</div>
<div class="section level2">
<h2 id="regression-model">Regression Model<a class="anchor" aria-label="anchor" href="#regression-model"></a>
</h2>
<p>We will now fit a GLS model with all main effects and interactions,
though without the group weights to start. Since body_mass is strictly
positive, and positive continuous data typically exhibits an increasing
mean–variance relationship, we will apply a log transformation. We will
need to ensure we back-transform the predictions for plotting later
on.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html" class="external-link">gls</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">body_mass</span><span class="op">)</span> <span class="op">~</span> <span class="op">(</span><span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">group</span> <span class="op">+</span> <span class="va">week</span><span class="op">)</span> <span class="op">^</span> <span class="fl">4</span>,</span>
<span>          data <span class="op">=</span> <span class="va">df</span>,</span>
<span>          correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corAR1.html" class="external-link">corAR1</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">pid</span><span class="op">)</span>,</span>
<span>          method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lme.html">plot_lme</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></code></pre></div>
<p><img src="WEEKLY_BODY_MASS_STATS_files/figure-html/unnamed-chunk-5-1.png" width="2400"></p>
<p>The residuals vs. fitted plot and QQ-plot look fine. We will check
for heteroscedasticity with boxplots of residuals vs. predictors.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="va">m1</span>, type <span class="op">=</span> <span class="st">"pearson"</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span><span class="op">)</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">r</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">df</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">r</span> <span class="op">~</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">df</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">r</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">df</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">r</span> <span class="op">~</span> <span class="va">week</span>, data <span class="op">=</span> <span class="va">df</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Standardized Residuals"</span>, side <span class="op">=</span> <span class="fl">2</span>, line <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, outer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Residuals vs. Predictors"</span>, outer <span class="op">=</span> <span class="cn">TRUE</span>, line <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="WEEKLY_BODY_MASS_STATS_files/figure-html/unnamed-chunk-6-1.png" width="2400"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>There appears to be differences in variability between the two age
groups, with 18M animals being less variable. We will account for this
in the model.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m1</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/varIdent.html" class="external-link">varIdent</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lme.html">plot_lme</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></span></code></pre></div>
<p><img src="WEEKLY_BODY_MASS_STATS_files/figure-html/unnamed-chunk-7-1.png" width="2400"></p>
<p>The diagnostic plots appear almost identical. We will examine the
boxplots again.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="va">m2</span>, type <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span><span class="op">)</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">r2</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">df</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">r2</span> <span class="op">~</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">df</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">r2</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">df</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">r2</span> <span class="op">~</span> <span class="va">week</span>, data <span class="op">=</span> <span class="va">df</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Pearson Residuals"</span>, side <span class="op">=</span> <span class="fl">2</span>, line <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, outer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Residuals vs. Predictors"</span>, outer <span class="op">=</span> <span class="cn">TRUE</span>, line <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="WEEKLY_BODY_MASS_STATS_files/figure-html/unnamed-chunk-8-1.png" width="2400"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The plots do not appear to change. We will compare the models.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">m1</span>, <span class="va">m2</span><span class="op">)</span></span>
<span><span class="co">#&gt;    df       AIC</span></span>
<span><span class="co">#&gt; m1 66 -4134.807</span></span>
<span><span class="co">#&gt; m2 67 -4134.393</span></span></code></pre></div>
<p>Even though the AIC is marginally higher, we will use the model
without weights, since their inclusion seems to have little effect on
the results, and the model without weights is simpler.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m1</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lme.html">plot_lme</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></code></pre></div>
<p><img src="WEEKLY_BODY_MASS_STATS_files/figure-html/unnamed-chunk-10-1.png" width="2400"></p>
<p>The diagnostic plots still look fine.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate mean body_mass for each combination of factors</span></span>
<span><span class="va">df_pred</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span>, <span class="va">week</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span>, <span class="va">week</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>body_mass_pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">m1</span>, newdata <span class="op">=</span> <span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">week</span>, y <span class="op">=</span> <span class="va">body_mass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">pid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">group</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">week</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">body_mass_pred</span><span class="op">)</span>,</span>
<span>            data <span class="op">=</span> <span class="va">df_pred</span>, color <span class="op">=</span> <span class="st">"red3"</span>,</span>
<span>            linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Weeks Since Protocol Began"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="WEEKLY_BODY_MASS_STATS_files/figure-html/unnamed-chunk-11-1.png" width="2400"></p>
</div>
<div class="section level2">
<h2 id="hypothesis-testing">Hypothesis Testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a>
</h2>
<p>At each week, for each combination of age and sex, we will test
whether the mean of the 8W group is different from the mean of the SED
group. P-values will be adjusted for multiple comparisons using the Holm
method to control the FWER within each combination of <code>age</code>
and <code>sex</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Weekly Body Mass"</span> <span class="op">=</span> <span class="va">m1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_chr</a></span><span class="op">(</span>.f <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="va">.x</span><span class="op">[[</span><span class="st">"call"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">enframe</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"response"</span>, </span>
<span>          value <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"(?&lt;=[\\s])\\s*|^\\s+|\\s+$"</span>, <span class="st">""</span>, <span class="va">model</span>, perl <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>         model_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^([^\\(]+).*"</span>, <span class="st">"\\1"</span>, <span class="va">model</span><span class="op">)</span>,</span>
<span>         formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">".*model = ([^,]+),.*"</span>, <span class="st">"\\1"</span>, <span class="va">model</span><span class="op">)</span>,</span>
<span>         correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">".*correlation = ([^,]+),?.*"</span>, <span class="st">"\\1"</span>, <span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">WEEKLY_BODY_MASS_EMM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html" class="external-link">emmeans</a></span><span class="op">(</span><span class="va">m1</span>, specs <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>                                by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"week"</span><span class="op">)</span>,</span>
<span>                                mode <span class="op">=</span> <span class="st">"df.error"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">WEEKLY_BODY_MASS_STATS</span> <span class="op">&lt;-</span> <span class="va">WEEKLY_BODY_MASS_EMM</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/contrast.html" class="external-link">contrast</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"trt.vs.ctrl"</span>, infer <span class="op">=</span> <span class="cn">TRUE</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Benjamini-Yekutieli multiple comparison adjustment for dependency within</span></span>
<span>  <span class="co"># each combination of age and sex (across the 8 weeks)</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p.value</span>, method <span class="op">=</span> <span class="st">"BY"</span><span class="op">)</span>,</span>
<span>         signif <span class="op">=</span> <span class="va">p.adj</span> <span class="op">&lt;</span> <span class="fl">0.05</span>,</span>
<span>         response <span class="op">=</span> <span class="st">"Weekly Body Mass"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">ratio</span>, </span>
<span>               names_to <span class="op">=</span> <span class="st">"estimate_type"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"estimate"</span>, </span>
<span>               values_drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">".ratio"</span><span class="op">)</span>, </span>
<span>               names_to <span class="op">=</span> <span class="st">"statistic_type"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"statistic"</span>, </span>
<span>               values_drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>statistic_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"\\.ratio"</span>, <span class="st">""</span>, <span class="va">statistic_type</span><span class="op">)</span>,</span>
<span>         statistic_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">statistic_type</span> <span class="op">==</span> <span class="st">"W"</span>, <span class="st">"wilcox.test"</span>, </span>
<span>                                 <span class="va">statistic_type</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">model_df</span>, by <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">response</span>, <span class="va">age</span>, <span class="va">sex</span>, <span class="va">week</span>, <span class="va">contrast</span>, <span class="va">estimate_type</span>, <span class="va">null</span>, </span>
<span>                <span class="va">estimate</span>, <span class="va">SE</span>, <span class="va">lower.CL</span>, <span class="va">upper.CL</span>, <span class="va">statistic_type</span>, <span class="va">statistic</span>, </span>
<span>                <span class="va">df</span>, <span class="va">p.value</span>, <span class="va">p.adj</span>, <span class="va">signif</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">week</span><span class="op">)</span></span></code></pre></div>
<p>See <code><a href="../reference/WEEKLY_BODY_MASS_STATS.html">?WEEKLY_BODY_MASS_STATS</a></code> for details.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.dataframe.html" class="external-link">print.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">WEEKLY_BODY_MASS_STATS</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;            response age    sex week contrast estimate_type null  estimate</span></span>
<span><span class="co">#&gt; 1  Weekly Body Mass  6M Female    1 8W / SED         ratio    1 1.0040409</span></span>
<span><span class="co">#&gt; 2  Weekly Body Mass  6M Female    2 8W / SED         ratio    1 0.9943136</span></span>
<span><span class="co">#&gt; 3  Weekly Body Mass  6M Female    3 8W / SED         ratio    1 0.9725313</span></span>
<span><span class="co">#&gt; 4  Weekly Body Mass  6M Female    4 8W / SED         ratio    1 0.9690735</span></span>
<span><span class="co">#&gt; 5  Weekly Body Mass  6M Female    5 8W / SED         ratio    1 0.9581031</span></span>
<span><span class="co">#&gt; 6  Weekly Body Mass  6M Female    6 8W / SED         ratio    1 0.9513232</span></span>
<span><span class="co">#&gt; 7  Weekly Body Mass  6M Female    7 8W / SED         ratio    1 0.9492987</span></span>
<span><span class="co">#&gt; 8  Weekly Body Mass  6M Female    8 8W / SED         ratio    1 0.9515022</span></span>
<span><span class="co">#&gt; 9  Weekly Body Mass  6M   Male    1 8W / SED         ratio    1 1.0046158</span></span>
<span><span class="co">#&gt; 10 Weekly Body Mass  6M   Male    2 8W / SED         ratio    1 0.9906118</span></span>
<span><span class="co">#&gt;            SE  lower.CL  upper.CL statistic_type  statistic  df     p.value</span></span>
<span><span class="co">#&gt; 1  0.01726843 0.9707087 1.0385177              t  0.2344792 781 0.814674439</span></span>
<span><span class="co">#&gt; 2  0.01710113 0.9613043 1.0284563              t -0.3315686 781 0.740303982</span></span>
<span><span class="co">#&gt; 3  0.01672650 0.9402451 1.0059260              t -1.6194645 781 0.105751048</span></span>
<span><span class="co">#&gt; 4  0.01666703 0.9369021 1.0023495              t -1.8265587 781 0.068147722</span></span>
<span><span class="co">#&gt; 5  0.01647835 0.9262960 0.9910025              t -2.4885184 781 0.013034981</span></span>
<span><span class="co">#&gt; 6  0.01636174 0.9197411 0.9839897              t -2.9014278 781 0.003819103</span></span>
<span><span class="co">#&gt; 7  0.01632693 0.9177839 0.9818958              t -3.0252879 781 0.002565424</span></span>
<span><span class="co">#&gt; 8  0.01636482 0.9199142 0.9841749              t -2.8904859 781 0.003953125</span></span>
<span><span class="co">#&gt; 9  0.01834532 0.9692416 1.0412810              t  0.2521849 781 0.800964508</span></span>
<span><span class="co">#&gt; 10 0.01808959 0.9557307 1.0267659              t -0.5165423 781 0.605621928</span></span>
<span><span class="co">#&gt;         p.adj signif model_type                                       formula</span></span>
<span><span class="co">#&gt; 1  1.00000000  FALSE        gls log(body_mass) ~ (age + sex + group + week)^4</span></span>
<span><span class="co">#&gt; 2  1.00000000  FALSE        gls log(body_mass) ~ (age + sex + group + week)^4</span></span>
<span><span class="co">#&gt; 3  0.38322166  FALSE        gls log(body_mass) ~ (age + sex + group + week)^4</span></span>
<span><span class="co">#&gt; 4  0.29634524  FALSE        gls log(body_mass) ~ (age + sex + group + week)^4</span></span>
<span><span class="co">#&gt; 5  0.07085443  FALSE        gls log(body_mass) ~ (age + sex + group + week)^4</span></span>
<span><span class="co">#&gt; 6  0.02865075   TRUE        gls log(body_mass) ~ (age + sex + group + week)^4</span></span>
<span><span class="co">#&gt; 7  0.02865075   TRUE        gls log(body_mass) ~ (age + sex + group + week)^4</span></span>
<span><span class="co">#&gt; 8  0.02865075   TRUE        gls log(body_mass) ~ (age + sex + group + week)^4</span></span>
<span><span class="co">#&gt; 9  1.00000000  FALSE        gls log(body_mass) ~ (age + sex + group + week)^4</span></span>
<span><span class="co">#&gt; 10 1.00000000  FALSE        gls log(body_mass) ~ (age + sex + group + week)^4</span></span>
<span><span class="co">#&gt;                correlation</span></span>
<span><span class="co">#&gt; 1  corAR1(form = ~1 | pid)</span></span>
<span><span class="co">#&gt; 2  corAR1(form = ~1 | pid)</span></span>
<span><span class="co">#&gt; 3  corAR1(form = ~1 | pid)</span></span>
<span><span class="co">#&gt; 4  corAR1(form = ~1 | pid)</span></span>
<span><span class="co">#&gt; 5  corAR1(form = ~1 | pid)</span></span>
<span><span class="co">#&gt; 6  corAR1(form = ~1 | pid)</span></span>
<span><span class="co">#&gt; 7  corAR1(form = ~1 | pid)</span></span>
<span><span class="co">#&gt; 8  corAR1(form = ~1 | pid)</span></span>
<span><span class="co">#&gt; 9  corAR1(form = ~1 | pid)</span></span>
<span><span class="co">#&gt; 10 corAR1(form = ~1 | pid)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] latex2exp_0.9.6                       </span></span>
<span><span class="co">#&gt; [2] emmeans_1.9.0                         </span></span>
<span><span class="co">#&gt; [3] nlme_3.1-163                          </span></span>
<span><span class="co">#&gt; [4] ggplot2_3.4.4                         </span></span>
<span><span class="co">#&gt; [5] tibble_3.2.1                          </span></span>
<span><span class="co">#&gt; [6] tidyr_1.3.0                           </span></span>
<span><span class="co">#&gt; [7] purrr_1.0.2                           </span></span>
<span><span class="co">#&gt; [8] dplyr_1.1.4                           </span></span>
<span><span class="co">#&gt; [9] MotrpacRatTrainingPhysiologyData_2.0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gtable_0.3.4       beeswarm_0.4.0     xfun_0.41          bslib_0.6.1       </span></span>
<span><span class="co">#&gt;  [5] rstatix_0.7.2      lattice_0.21-9     vctrs_0.6.5        tools_4.3.2       </span></span>
<span><span class="co">#&gt;  [9] generics_0.1.3     fansi_1.0.6        highr_0.10         pkgconfig_2.0.3   </span></span>
<span><span class="co">#&gt; [13] desc_1.4.3         lifecycle_1.0.4    compiler_4.3.2     farver_2.1.1      </span></span>
<span><span class="co">#&gt; [17] stringr_1.5.1      textshaping_0.3.7  munsell_0.5.0      carData_3.0-5     </span></span>
<span><span class="co">#&gt; [21] vipor_0.4.7        htmltools_0.5.7    sass_0.4.8         yaml_2.3.8        </span></span>
<span><span class="co">#&gt; [25] pillar_1.9.0       pkgdown_2.0.7      car_3.1-2          ggpubr_0.6.0      </span></span>
<span><span class="co">#&gt; [29] jquerylib_0.1.4    cachem_1.0.8       abind_1.4-5        tidyselect_1.2.0  </span></span>
<span><span class="co">#&gt; [33] digest_0.6.34      mvtnorm_1.2-4      stringi_1.8.3      labeling_0.4.3    </span></span>
<span><span class="co">#&gt; [37] fastmap_1.1.1      grid_4.3.2         colorspace_2.1-0   cli_3.6.2         </span></span>
<span><span class="co">#&gt; [41] magrittr_2.0.3     utf8_1.2.4         broom_1.0.5        withr_3.0.0       </span></span>
<span><span class="co">#&gt; [45] scales_1.3.0       backports_1.4.1    ggbeeswarm_0.7.2   estimability_1.4.1</span></span>
<span><span class="co">#&gt; [49] rmarkdown_2.25     ggsignif_0.6.4     ragg_1.2.7         memoise_2.0.1     </span></span>
<span><span class="co">#&gt; [53] evaluate_0.23      knitr_1.45         rlang_1.1.3        glue_1.7.0        </span></span>
<span><span class="co">#&gt; [57] jsonlite_1.8.8     R6_2.5.1           systemfonts_1.0.5  fs_1.6.3</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tyler J. Sagendorf.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
