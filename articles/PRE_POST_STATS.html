<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Statistical analyses of post- vs. pre-training body composition and VO2max testing measures • MotrpacRatTrainingPhysiologyData</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Statistical analyses of post- vs. pre-training body composition and VO2max testing measures">
<meta property="og:description" content="MotrpacRatTrainingPhysiologyData">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MotrpacRatTrainingPhysiologyData</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/analyte_plots.html">Plots of plasma clinical analytes</a>
    </li>
    <li>
      <a href="../articles/ANALYTES_STATS.html">Statistical analyses of plasma clinical analytes</a>
    </li>
    <li>
      <a href="../articles/baseline_plots.html">Plots of baseline body composition and VO2max testing measures</a>
    </li>
    <li>
      <a href="../articles/BASELINE_STATS.html">Statistical analyses of baseline body composition and VO2max testing measures</a>
    </li>
    <li>
      <a href="../articles/dissection_time_plots.html">Plots of tissue dissection times</a>
    </li>
    <li>
      <a href="../articles/fiber_area_plots.html">Plots of fiber area by muscle and fiber type</a>
    </li>
    <li>
      <a href="../articles/FIBER_AREA_STATS.html">Statistical analysis of mean fiber area by muscle and fiber type</a>
    </li>
    <li>
      <a href="../articles/fiber_count_plots.html">Plots of muscle fiber type percentages</a>
    </li>
    <li>
      <a href="../articles/FIBER_COUNT_STATS.html">Statistical analysis of fiber counts by muscle and fiber type</a>
    </li>
    <li>
      <a href="../articles/muscle_plots.html">Plots of muscle-specific measures</a>
    </li>
    <li>
      <a href="../articles/MUSCLES_STATS.html">Statistical analyses of muscle-specific measures</a>
    </li>
    <li>
      <a href="../articles/pre_post_plots.html">Plots of post- vs. pre-training body composition and VO2max testing measures</a>
    </li>
    <li>
      <a href="../articles/PRE_POST_STATS.html">Statistical analyses of post- vs. pre-training body composition and VO2max testing measures</a>
    </li>
    <li>
      <a href="../articles/WEEKLY_BODY_MASS_STATS.html">Statistical analysis of weekly body mass</a>
    </li>
    <li>
      <a href="../articles/weekly_measures_plots.html">Plots of weekly body mass and blood lactate</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MoTrPAC/MotrpacRatTrainingPhysiologyData/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Statistical analyses of post- vs. pre-training
body composition and VO2max testing measures</h1>
                        <h4 data-toc-skip class="author">Tyler
Sagendorf</h4>
            
            <h4 data-toc-skip class="date">01 May, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTrainingPhysiologyData/blob/HEAD/vignettes/PRE_POST_STATS.Rmd" class="external-link"><code>vignettes/PRE_POST_STATS.Rmd</code></a></small>
      <div class="hidden name"><code>PRE_POST_STATS.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MoTrPAC/MotrpacRatTrainingPhysiologyData/" class="external-link">MotrpacRatTrainingPhysiologyData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/emmeans" class="external-link">emmeans</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stefanom.io/latex2exp/" class="external-link">latex2exp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/rstatix/" class="external-link">rstatix</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># base plot theme</span></span></code></pre></div>
<div class="section level2">
<h2 id="regression-models">Regression Models<a class="anchor" aria-label="anchor" href="#regression-models"></a>
</h2>
<p>We will fit linear regression models with age, sex, group, and their
interactions as predictors of the differences between post- and
pre-training values for different measures of body mass, body
composition, and VO<span class="math inline">\(_2\)</span>max. If
heteroscedasticity is observed, we will include reciprocal group
variances as weights. Certain observations may be removed if their
inclusion substantially affects the model fit. Model parsimony will be
achieved through ANOVA F-tests.</p>
<div class="section level3">
<h3 id="nmr-body-mass">NMR Body Mass<a class="anchor" aria-label="anchor" href="#nmr-body-mass"></a>
</h3>
<p>Body mass recorded on the same day as the NMR body composition
measures.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot points</span></span>
<span><span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">post_body_mass</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">post_body_mass</span> <span class="op">-</span> <span class="va">pre_body_mass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             na.rm <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NMR total body mass (post - pre)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>There is one negative outlying value in the 6M SED male group that
may affect the model fit. We will start with a WLS model, since we
observe different group variances.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt.body_mass</span> <span class="op">&lt;-</span> <span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">post_body_mass</span> <span class="op">-</span> <span class="va">pre_body_mass</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.body_mass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">post_body_mass</span> <span class="op">-</span> <span class="va">pre_body_mass</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">*</span> <span class="va">sex</span> <span class="op">*</span> <span class="va">group</span>,</span>
<span>                    weights <span class="op">=</span> <span class="va">wt.body_mass</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">NMR</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.body_mass</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>The diagnostic plots appear fine.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.body_mass</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: I(post_body_mass - pre_body_mass)</span></span>
<span><span class="co">#&gt;                Df Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; age             1 227.94  227.94 227.9378 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; sex             1 490.51  490.51 490.5147 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; group           2  63.78   31.89  31.8906 2.099e-12 ***</span></span>
<span><span class="co">#&gt; age:sex         1  12.36   12.36  12.3552 0.0005704 ***</span></span>
<span><span class="co">#&gt; age:group       2  16.10    8.05   8.0491 0.0004648 ***</span></span>
<span><span class="co">#&gt; sex:group       2  53.63   26.81  26.8147 8.717e-11 ***</span></span>
<span><span class="co">#&gt; age:sex:group   2   2.76    1.38   1.3816 0.2541112    </span></span>
<span><span class="co">#&gt; Residuals     162 162.00    1.00                       </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="w-2w-terminal---pre-nmr-body-mass">1W, 2W: Terminal - Pre NMR Body Mass<a class="anchor" aria-label="anchor" href="#w-2w-terminal---pre-nmr-body-mass"></a>
</h3>
<p>Pre: body mass recorded on the same day as the NMR body composition
measures in the 1W and 2W groups. Post: body mass recorded upon death
(terminal body mass).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">term_nmr_df</span> <span class="op">&lt;-</span> <span class="va">BODY_MASSES</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1W"</span>, <span class="st">"2W"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lm.ridge.html" class="external-link">select</a></span><span class="op">(</span><span class="va">pid</span>, <span class="va">iowa_id</span>, <span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span>, <span class="va">term_body_mass</span>, <span class="va">nmr_pre_body_mass</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">term_body_mass</span> <span class="op">-</span> <span class="va">nmr_pre_body_mass</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot points</span></span>
<span><span class="va">p_term</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">term_nmr_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"terminal - NMR body mass (pre)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_term</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>There is an extreme observation in both 6M Male groups.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">term_nmr_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">nmr_pre_body_mass</span>, y <span class="op">=</span> <span class="va">term_body_mass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-6-1.png" width="384"></p>
<p>We see the outlier in the 6M 2W male group is an outlier in the
scatterplot. We will plot the data without that observation.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove those two points and update the plot</span></span>
<span><span class="va">p_term</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">term_nmr_df</span>, <span class="va">diff</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">p_term</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>Nearly every group has at least one outlying sample, and the groups
have different variances. We will remove that extremely negative outlier
and fit a WLS model.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out.term_nmr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">term_nmr_df</span><span class="op">$</span><span class="va">diff</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">50</span><span class="op">)</span> <span class="co"># 58</span></span>
<span></span>
<span><span class="va">wt.term_nmr</span> <span class="op">&lt;-</span> <span class="va">term_nmr_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>term_body_mass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">out.term_nmr</span>, </span>
<span>                                 <span class="cn">NA</span>, <span class="va">term_body_mass</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">term_body_mass</span> <span class="op">-</span> <span class="va">nmr_pre_body_mass</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.term_nmr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">term_body_mass</span> <span class="op">-</span> <span class="va">nmr_pre_body_mass</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">*</span> <span class="va">sex</span> <span class="op">*</span> <span class="va">group</span>,</span>
<span>                   weights <span class="op">=</span> <span class="va">wt.term_nmr</span>,</span>
<span>                   subset <span class="op">=</span> <span class="op">-</span><span class="va">out.term_nmr</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">term_nmr_df</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.term_nmr</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>The diagnostic plots look mostly fine.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.term_nmr</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: I(term_body_mass - nmr_pre_body_mass)</span></span>
<span><span class="co">#&gt;               Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; age            1  45.106  45.106  45.1065  1.19e-09 ***</span></span>
<span><span class="co">#&gt; sex            1 102.394 102.394 102.3936 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; group          1   7.376   7.376   7.3757  0.007803 ** </span></span>
<span><span class="co">#&gt; age:sex        1   4.468   4.468   4.4676  0.037056 *  </span></span>
<span><span class="co">#&gt; age:group      1   2.730   2.730   2.7302  0.101634    </span></span>
<span><span class="co">#&gt; sex:group      1   7.001   7.001   7.0007  0.009479 ** </span></span>
<span><span class="co">#&gt; age:sex:group  1   4.830   4.830   4.8301  0.030298 *  </span></span>
<span><span class="co">#&gt; Residuals     99  99.000   1.000                       </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="nmr-lean-mass">NMR Lean Mass<a class="anchor" aria-label="anchor" href="#nmr-lean-mass"></a>
</h3>
<p>Lean mass (g) recorded via NMR.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot points</span></span>
<span><span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">post_lean</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">post_lean</span> <span class="op">-</span> <span class="va">pre_lean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             na.rm <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NMR lean mass (post - pre)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>We observe several outlying values in several of the 6M male
groups.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.lean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">post_lean</span> <span class="op">-</span> <span class="va">pre_lean</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">*</span> <span class="va">sex</span> <span class="op">*</span> <span class="va">group</span>,</span>
<span>               data <span class="op">=</span> <span class="va">NMR</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.lean</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>Observations 80, 89, and 140 are outlying, and greatly impact group
variances. We will try inverse group variance weights.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NMR</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">89</span>, <span class="fl">140</span><span class="op">)</span>, <span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lm.ridge.html" class="external-link">select</a></span><span class="op">(</span><span class="va">pid</span>, <span class="va">iowa_id</span>, <span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span>, <span class="va">pre_lean</span>, <span class="va">post_lean</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">post_lean</span> <span class="op">-</span> <span class="va">pre_lean</span><span class="op">)</span></span>
<span><span class="co">#&gt;          pid iowa_id age  sex group pre_lean post_lean     diff</span></span>
<span><span class="co">#&gt; 80  10023259  06M8T1  6M Male   SED 188.9168  222.7589  33.8421</span></span>
<span><span class="co">#&gt; 89  10027327 06M8T25  6M Male   SED 207.9840  195.4080 -12.5760</span></span>
<span><span class="co">#&gt; 140 10024735  06M8T3  6M Male    8W 188.7944  164.2659 -24.5285</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt.lean</span> <span class="op">&lt;-</span> <span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">post_lean</span> <span class="op">-</span> <span class="va">pre_lean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.lean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fit.lean</span>, weights <span class="op">=</span> <span class="va">wt.lean</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.lean</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p>The diagnostic plots seem mostly fine.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.lean</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: I(post_lean - pre_lean)</span></span>
<span><span class="co">#&gt;                Df Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; age             1 667.80  667.80 667.7986 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; sex             1  38.21   38.21  38.2125 4.960e-09 ***</span></span>
<span><span class="co">#&gt; group           2  31.51   15.76  15.7556 5.591e-07 ***</span></span>
<span><span class="co">#&gt; age:sex         1   1.47    1.47   1.4655   0.22782    </span></span>
<span><span class="co">#&gt; age:group       2  20.93   10.46  10.4635 5.324e-05 ***</span></span>
<span><span class="co">#&gt; sex:group       2  12.69    6.35   6.3464   0.00222 ** </span></span>
<span><span class="co">#&gt; age:sex:group   2   2.96    1.48   1.4778   0.23120    </span></span>
<span><span class="co">#&gt; Residuals     162 162.00    1.00                       </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="nmr-fat-mass">NMR Fat Mass<a class="anchor" aria-label="anchor" href="#nmr-fat-mass"></a>
</h3>
<p>Fat mass (g) recorded via NMR.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot points</span></span>
<span><span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">post_fat</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">post_fat</span> <span class="op">-</span> <span class="va">pre_fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             na.rm <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NMR fat mass (post - pre)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<p>We observe unequal group variances, and several outlying values
(especially in the 6M 4W male group). We will fit a WLS model with
reciprocal group variances as weights.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt.fat</span> <span class="op">&lt;-</span> <span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">post_fat</span> <span class="op">-</span> <span class="va">pre_fat</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.fat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">post_fat</span> <span class="op">-</span> <span class="va">pre_fat</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">*</span> <span class="va">sex</span> <span class="op">*</span> <span class="va">group</span>,</span>
<span>              weights <span class="op">=</span> <span class="va">wt.fat</span>,</span>
<span>              data <span class="op">=</span> <span class="va">NMR</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.fat</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
<p>The diagnostic plots seem mostly fine.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.fat</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: I(post_fat - pre_fat)</span></span>
<span><span class="co">#&gt;                Df Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; age             1 114.28  114.28 114.2755 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; sex             1 486.51  486.51 486.5055 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; group           2 164.85   82.43  82.4260 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; age:sex         1   1.84    1.84   1.8387    0.1770    </span></span>
<span><span class="co">#&gt; age:group       2  19.81    9.90   9.9047 8.746e-05 ***</span></span>
<span><span class="co">#&gt; sex:group       2  84.61   42.31  42.3067 1.650e-15 ***</span></span>
<span><span class="co">#&gt; age:sex:group   2   1.25    0.62   0.6229    0.5377    </span></span>
<span><span class="co">#&gt; Residuals     162 162.00    1.00                       </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="nmr-lean-mass-1">NMR % Lean Mass<a class="anchor" aria-label="anchor" href="#nmr-lean-mass-1"></a>
</h3>
<p>Lean mass (g) recorded via NMR divided by the body mass (g) recorded
on the same day and then multiplied by 100%.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot points</span></span>
<span><span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">post_lean_pct</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">post_lean_pct</span> <span class="op">-</span> <span class="va">pre_lean_pct</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             na.rm <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NMR % lean mass (post - pre)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
<p>We observe several outlying values in several of the 6M male groups,
similar to the plot of the differences in lean mass. We also observe
unequal group variances, so we will fit a WLS model with reciprocal
group variances as weights.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt.lean_pct</span> <span class="op">&lt;-</span> <span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sex</span>, <span class="va">group</span>, <span class="va">age</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">post_lean_pct</span> <span class="op">-</span> <span class="va">pre_lean_pct</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.lean_pct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">post_lean_pct</span> <span class="op">-</span> <span class="va">pre_lean_pct</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">*</span> <span class="va">sex</span> <span class="op">*</span> <span class="va">group</span>,</span>
<span>                   weights <span class="op">=</span> <span class="va">wt.lean_pct</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">NMR</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.lean_pct</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
<p>The diagnostic plots look mostly fine.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.lean_pct</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: I(post_lean_pct - pre_lean_pct)</span></span>
<span><span class="co">#&gt;                Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; age             1  16.900  16.900  16.9003 6.246e-05 ***</span></span>
<span><span class="co">#&gt; sex             1 222.038 222.038 222.0380 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; group           2 113.016  56.508  56.5079 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; age:sex         1   6.648   6.648   6.6481  0.010816 *  </span></span>
<span><span class="co">#&gt; age:group       2  12.336   6.168   6.1679  0.002621 ** </span></span>
<span><span class="co">#&gt; sex:group       2  11.304   5.652   5.6519  0.004239 ** </span></span>
<span><span class="co">#&gt; age:sex:group   2   4.490   2.245   2.2451  0.109202    </span></span>
<span><span class="co">#&gt; Residuals     162 162.000   1.000                       </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="nmr-fat-mass-1">NMR % Fat Mass<a class="anchor" aria-label="anchor" href="#nmr-fat-mass-1"></a>
</h3>
<p>Fat mass (g) recorded via NMR divided by the body mass (g) recorded
on the same day and then multiplied by 100%.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot points</span></span>
<span><span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">post_fat_pct</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">post_fat_pct</span> <span class="op">-</span> <span class="va">pre_fat_pct</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             na.rm <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NMR % fat mass (post - pre)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
<p>There are several groups with outlying values: mainly, two from the
6M 4W males and one from the 18M 8W females. We will try an OLS model
first.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.fat_pct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">post_fat_pct</span> <span class="op">-</span> <span class="va">pre_fat_pct</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">*</span> <span class="va">sex</span> <span class="op">*</span> <span class="va">group</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">NMR</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.fat_pct</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
<p>Those extreme values are being flagged in the diagnostic plots.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NMR</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">136</span>, <span class="fl">138</span>, <span class="fl">218</span><span class="op">)</span>, <span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lm.ridge.html" class="external-link">select</a></span><span class="op">(</span><span class="va">pid</span>, <span class="va">iowa_id</span>, <span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span>, <span class="va">post_fat_pct</span>, <span class="va">pre_fat_pct</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">post_fat_pct</span> <span class="op">-</span> <span class="va">pre_fat_pct</span><span class="op">)</span></span>
<span><span class="co">#&gt;          pid iowa_id age    sex group post_fat_pct pre_fat_pct diff</span></span>
<span><span class="co">#&gt; 136 10185585 06M4T17  6M   Male    4W         15.4        12.2  3.2</span></span>
<span><span class="co">#&gt; 138 10219315 06M4T19  6M   Male    4W         10.1        17.9 -7.8</span></span>
<span><span class="co">#&gt; 218 11623578 18F8T29 18M Female    8W         17.9        14.3  3.6</span></span></code></pre></div>
<p>The two outliers in the 6M 4W male group are about equidistant from
the mean of the other values, so their removal will only shrink the
variance of the group. Removal of the 18M 8W female sample, however,
will reduce the variance and shift the mean away from 0. We will try a
WLS model and remove these observations, since they have a huge impact
on the group variances and would shift the right tail of the QQ-plot if
they were included.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We will remove these values, but keep the rows.</span></span>
<span><span class="co"># This is so we can use the subset argument in update, which</span></span>
<span><span class="co"># is easier to keep track of when we extract model info later.</span></span>
<span><span class="va">wt.fat_pct</span> <span class="op">&lt;-</span> <span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>idx <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>         post_fat_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">idx</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">136</span>, <span class="fl">138</span>, <span class="fl">218</span><span class="op">)</span>, </span>
<span>                               <span class="cn">NA</span>, <span class="va">post_fat_pct</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">post_fat_pct</span> <span class="op">-</span> <span class="va">pre_fat_pct</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.fat_pct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fit.fat_pct</span>, </span>
<span>                      subset <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">136</span>, <span class="fl">138</span>, <span class="fl">218</span><span class="op">)</span>, </span>
<span>                      weights <span class="op">=</span> <span class="va">wt.fat_pct</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.fat_pct</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-24-1.png" width="672"></p>
<p>The diagnostic plots look fine.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.fat_pct</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: I(post_fat_pct - pre_fat_pct)</span></span>
<span><span class="co">#&gt;                Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; age             1  47.211  47.211  47.2106 1.366e-10 ***</span></span>
<span><span class="co">#&gt; sex             1 197.607 197.607 197.6068 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; group           2 269.226 134.613 134.6130 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; age:sex         1  11.809  11.809  11.8088 0.0007523 ***</span></span>
<span><span class="co">#&gt; age:group       2  34.278  17.139  17.1388 1.818e-07 ***</span></span>
<span><span class="co">#&gt; sex:group       2  32.821  16.411  16.4107 3.317e-07 ***</span></span>
<span><span class="co">#&gt; age:sex:group   2   5.052   2.526   2.5258 0.0831965 .  </span></span>
<span><span class="co">#&gt; Residuals     159 159.000   1.000                       </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="absolute-vo_2max">Absolute VO<span class="math inline">\(_2\)</span>max<a class="anchor" aria-label="anchor" href="#absolute-vo_2max"></a>
</h3>
<p>Absolute VO<span class="math inline">\(_2\)</span>max is calculated
by multiplying relative VO<span class="math inline">\(_2\)</span>max
(<span class="math inline">\(mL \cdot kg^{-1} \cdot min^{-1}\)</span>)
by body mass (kg).</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot points</span></span>
<span><span class="va">VO2MAX</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">post_vo2max_ml_min</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">post_vo2max_ml_min</span> <span class="op">-</span> <span class="va">pre_vo2max_ml_min</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             na.rm <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html" class="external-link">TeX</a></span><span class="op">(</span><span class="st">"Absolute VO$_2$max (post - pre)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-26-1.png" width="672"></p>
<p>Several groups have both large and small outlying values. Namely, 6M
SED and 4W males and 18M SED females. Also, we do not have data for the
18M 4W groups of either sex, so certain coefficients will be
inestimable. To handle this, we will combine age and group into a single
factor.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Concatenate age and group</span></span>
<span><span class="va">VO2MAX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">VO2MAX</span>, age_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">age</span>, <span class="st">"_"</span>, <span class="va">group</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.vo2max_abs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">post_vo2max_ml_min</span> <span class="op">-</span> <span class="va">pre_vo2max_ml_min</span><span class="op">)</span> <span class="op">~</span> </span>
<span>                       <span class="va">age_group</span> <span class="op">*</span> <span class="va">sex</span>,</span>
<span>                     data <span class="op">=</span> <span class="va">VO2MAX</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.vo2max_abs</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-27-1.png" width="672"></p>
<p>The diagnostic plots look mostly fine.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.vo2max_abs</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: I(post_vo2max_ml_min - pre_vo2max_ml_min)</span></span>
<span><span class="co">#&gt;                Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; age_group       4 142.601  35.650 25.8418 8.482e-16 ***</span></span>
<span><span class="co">#&gt; sex             1   1.881   1.881  1.3638    0.2450    </span></span>
<span><span class="co">#&gt; age_group:sex   4   5.913   1.478  1.0715    0.3733    </span></span>
<span><span class="co">#&gt; Residuals     131 180.721   1.380                      </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="relative-vo_2max">Relative VO<span class="math inline">\(_2\)</span>max<a class="anchor" aria-label="anchor" href="#relative-vo_2max"></a>
</h3>
<p>Relative VO<span class="math inline">\(_2\)</span>max (mL/kg body
mass/min).</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot points</span></span>
<span><span class="va">VO2MAX</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">post_vo2max_ml_kg_min</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, </span>
<span>             y <span class="op">=</span> <span class="va">post_vo2max_ml_kg_min</span> <span class="op">-</span> <span class="va">pre_vo2max_ml_kg_min</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             na.rm <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Relative VO2max (post - pre)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-29-1.png" width="672"></p>
<p>There is an outlying sample in the 18M SED female group.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.vo2max_rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">post_vo2max_ml_kg_min</span> <span class="op">-</span> <span class="va">pre_vo2max_ml_kg_min</span><span class="op">)</span> <span class="op">~</span> </span>
<span>                       <span class="va">age_group</span> <span class="op">*</span> <span class="va">sex</span>,</span>
<span>                     data <span class="op">=</span> <span class="va">VO2MAX</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.vo2max_rel</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-30-1.png" width="672"></p>
<p>The diagnostic plots look mostly fine, though we observe unequal
group variances. We will include inverse group variance weights in an
attempt to stabilize the variance.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt.vo2max_rel</span> <span class="op">&lt;-</span> <span class="va">VO2MAX</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="va">sex</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">post_vo2max_ml_kg_min</span> <span class="op">-</span> <span class="va">pre_vo2max_ml_kg_min</span>,</span>
<span>                 na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.vo2max_rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fit.vo2max_rel</span>, weights <span class="op">=</span> <span class="va">wt.vo2max_rel</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.vo2max_rel</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-31-1.png" width="672"></p>
<p>The diagnostic plots look a bit better, and the mean-variance
relationship appears constant.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.vo2max_rel</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: I(post_vo2max_ml_kg_min - pre_vo2max_ml_kg_min)</span></span>
<span><span class="co">#&gt;                Df  Sum Sq Mean Sq F value Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; age_group       4 227.943  56.986 56.9858 &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; sex             1   0.437   0.437  0.4367 0.5099    </span></span>
<span><span class="co">#&gt; age_group:sex   4   3.446   0.862  0.8615 0.4890    </span></span>
<span><span class="co">#&gt; Residuals     131 131.000   1.000                   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="maximum-run-speed">Maximum Run Speed<a class="anchor" aria-label="anchor" href="#maximum-run-speed"></a>
</h3>
<p>Since run speed was increased in 1.8 m/min increments, as defined in
the training protocol, it may be better to use a non-parametric test.
Rather than plotting the individual points for the differences, since
they can only take on a few different values, we will instead count the
number of samples that take on a particular value in each group and
scale the points accordingly.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot points</span></span>
<span><span class="va">VO2MAX</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">post_speed_max</span> <span class="op">-</span> <span class="va">pre_speed_max</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span>, <span class="va">diff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">diff</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size_area</a></span><span class="op">(</span>max_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Maximum Run Speed (post - pre)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-33-1.png" width="672"></p>
<p>Most groups only take on 4 or 5 different values. We will use
Wilcoxon Rank Sum tests to compare each trained group to their matching
control group. We will adjust p-values within each age and sex group
after we set up comparisons for all measures.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Testing the differences is equivalent to a paired test</span></span>
<span><span class="va">speed_res</span> <span class="op">&lt;-</span> <span class="va">VO2MAX</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">post_speed_max</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>speed_diff <span class="op">=</span> <span class="va">post_speed_max</span> <span class="op">-</span> <span class="va">pre_speed_max</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/wilcox_test.html" class="external-link">wilcox_test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">speed_diff</span> <span class="op">~</span> <span class="fl">1</span>, mu <span class="op">=</span> <span class="fl">0</span>,</span>
<span>              detailed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              p.adjust.method <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>p.value <span class="op">=</span> <span class="va">p</span>,</span>
<span>                lower.CL <span class="op">=</span> <span class="va">conf.low</span>, </span>
<span>                upper.CL <span class="op">=</span> <span class="va">conf.high</span>,</span>
<span>                W.ratio <span class="op">=</span> <span class="va">statistic</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, </span>
<span>                <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.nan</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span>, <span class="va">estimate</span>, <span class="va">lower.CL</span>, <span class="va">upper.CL</span>,</span>
<span>                <span class="va">n</span>, <span class="va">W.ratio</span>, <span class="va">p.value</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="hypothesis-testing">Hypothesis Testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a>
</h2>
<p>We will test if group means are different from 0 and adjust p-values
using the Holm procedure within each combination of sex and age.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We will include the maximum run speed test results at the end</span></span>
<span><span class="va">model_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"NMR Body Mass"</span> <span class="op">=</span> <span class="va">fit.body_mass</span>,</span>
<span>                   <span class="st">"Term - NMR Pre Body Mass"</span> <span class="op">=</span> <span class="va">fit.term_nmr</span>,</span>
<span>                   <span class="st">"NMR Lean Mass"</span> <span class="op">=</span> <span class="va">fit.lean</span>,</span>
<span>                   <span class="st">"NMR Fat Mass"</span> <span class="op">=</span> <span class="va">fit.fat</span>,</span>
<span>                   <span class="st">"NMR % Lean"</span> <span class="op">=</span> <span class="va">fit.lean_pct</span>,</span>
<span>                   <span class="st">"NMR % Fat"</span> <span class="op">=</span> <span class="va">fit.fat_pct</span>,</span>
<span>                   <span class="st">"Absolute VO2max"</span> <span class="op">=</span> <span class="va">fit.vo2max_abs</span>,</span>
<span>                   <span class="st">"Relative VO2max"</span> <span class="op">=</span> <span class="va">fit.vo2max_rel</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract model info</span></span>
<span><span class="va">model_df</span> <span class="op">&lt;-</span> <span class="va">model_list</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_chr</a></span><span class="op">(</span>.f <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="va">.x</span><span class="op">[[</span><span class="st">"call"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">enframe</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"response"</span>, </span>
<span>          value <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"(?&lt;=[\\s])\\s*|^\\s+|\\s+$"</span>, <span class="st">""</span>, <span class="va">model</span>, perl <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>         model_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^([^\\(]+).*"</span>, <span class="st">"\\1"</span>, <span class="va">model</span><span class="op">)</span>,</span>
<span>         formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">".*formula = ([^,]+),.*"</span>, <span class="st">"\\1"</span>, <span class="va">model</span><span class="op">)</span>,</span>
<span>         <span class="co"># if weights were used, they were reciprocal group variances</span></span>
<span>         weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"weights = "</span>, <span class="va">model</span><span class="op">)</span>, </span>
<span>                          <span class="st">"reciprocal group variances"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">model</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>obs_removed <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">response</span> <span class="op">==</span> <span class="st">"Term - NMR Pre Body Mass"</span> <span class="op">~</span> <span class="va">NMR</span><span class="op">$</span><span class="va">iowa_id</span><span class="op">[</span><span class="fl">58</span><span class="op">]</span>,</span>
<span>    <span class="va">response</span> <span class="op">==</span> <span class="st">"NMR % Fat"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">NMR</span><span class="op">$</span><span class="va">iowa_id</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">136</span>, <span class="fl">138</span>, <span class="fl">218</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                    collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimated marginal means</span></span>
<span><span class="va">PRE_POST_STATS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">model_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">mod_i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">terms_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/terms.html" class="external-link">terms</a></span><span class="op">(</span><span class="va">mod_i</span><span class="op">)</span>, which <span class="op">=</span> <span class="st">"term.labels"</span><span class="op">)</span></span>
<span>  <span class="va">specs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age_group"</span>, <span class="st">"group"</span><span class="op">)</span>, <span class="va">terms_i</span><span class="op">)</span></span>
<span>  <span class="va">by</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"sex"</span><span class="op">)</span>, <span class="va">terms_i</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">by</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">by</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html" class="external-link">emmeans</a></span><span class="op">(</span><span class="va">mod_i</span>, specs <span class="op">=</span> <span class="va">specs</span>, by <span class="op">=</span> <span class="va">by</span>, infer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">specs</span> <span class="op">==</span> <span class="st">"age_group"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>                  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"_.*"</span>, <span class="st">""</span>, <span class="va">age_group</span><span class="op">)</span>,</span>
<span>                  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">".*_"</span>, <span class="st">""</span>, <span class="va">age_group</span><span class="op">)</span>,</span>
<span>                  age_group <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Include maximum run speed results</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Maximum Run Speed"</span> <span class="op">=</span> <span class="va">speed_res</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">enframe</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span>, <span class="st">"Female, Male"</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_longer_delim.html" class="external-link">separate_longer_delim</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">sex</span>, delim <span class="op">=</span> <span class="st">", "</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">response</span>, <span class="va">age</span>, <span class="va">sex</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p.value</span>, method <span class="op">=</span> <span class="st">"holm"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>signif <span class="op">=</span> <span class="va">p.adj</span> <span class="op">&lt;</span> <span class="fl">0.05</span>,</span>
<span>         age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">age</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"6M"</span>, <span class="st">"18M"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sex</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">group</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SED"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">^</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, <span class="st">"W"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">emmean</span>, <span class="va">estimate</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"estimate_type"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"estimate"</span>,</span>
<span>               values_drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">".ratio"</span><span class="op">)</span>, </span>
<span>               names_to <span class="op">=</span> <span class="st">"statistic_type"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"statistic"</span>, </span>
<span>               values_drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">model_df</span>, by <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>estimate_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">estimate_type</span> <span class="op">==</span> <span class="st">"emmean"</span>,</span>
<span>                                <span class="st">"(post - pre) mean"</span>, </span>
<span>                                <span class="st">"signed mean (post - pre) rank"</span><span class="op">)</span>,</span>
<span>         statistic_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"\\.ratio"</span>, <span class="st">""</span>, <span class="va">statistic_type</span><span class="op">)</span>,</span>
<span>         model_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">statistic_type</span> <span class="op">==</span> <span class="st">"W"</span>, </span>
<span>                             <span class="st">"wilcox.test"</span>, <span class="va">model_type</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">response</span>, <span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span>, <span class="va">estimate_type</span>, <span class="va">estimate</span>, <span class="va">SE</span>, </span>
<span>                <span class="va">lower.CL</span>, <span class="va">upper.CL</span>, <span class="va">statistic_type</span>, <span class="va">statistic</span>, <span class="va">df</span>, <span class="va">n</span>, <span class="va">p.value</span>, </span>
<span>                <span class="va">p.adj</span>, <span class="va">signif</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">response</span>, <span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span><span class="op">)</span></span></code></pre></div>
<p>See <code><a href="../reference/PRE_POST_STATS.html">?PRE_POST_STATS</a></code> for details.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.dataframe.html" class="external-link">print.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">PRE_POST_STATS</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;           response age    sex group     estimate_type    estimate        SE</span></span>
<span><span class="co">#&gt; 1  Absolute VO2max  6M Female   SED (post - pre) mean  0.13140308 0.3390616</span></span>
<span><span class="co">#&gt; 2  Absolute VO2max  6M Female    4W (post - pre) mean  0.50387815 0.2626360</span></span>
<span><span class="co">#&gt; 3  Absolute VO2max  6M Female    8W (post - pre) mean  2.59445165 0.2848687</span></span>
<span><span class="co">#&gt; 4  Absolute VO2max  6M   Male   SED (post - pre) mean -0.06767375 0.3390616</span></span>
<span><span class="co">#&gt; 5  Absolute VO2max  6M   Male    4W (post - pre) mean  0.79609433 0.2768426</span></span>
<span><span class="co">#&gt; 6  Absolute VO2max  6M   Male    8W (post - pre) mean  2.50046746 0.3257598</span></span>
<span><span class="co">#&gt; 7  Absolute VO2max 18M Female   SED (post - pre) mean -0.05819820 0.3714234</span></span>
<span><span class="co">#&gt; 8  Absolute VO2max 18M Female    8W (post - pre) mean  1.94151750 0.2936359</span></span>
<span><span class="co">#&gt; 9  Absolute VO2max 18M   Male   SED (post - pre) mean -0.72448938 0.4152639</span></span>
<span><span class="co">#&gt; 10 Absolute VO2max 18M   Male    8W (post - pre) mean  1.16158407 0.3032659</span></span>
<span><span class="co">#&gt;       lower.CL   upper.CL statistic_type  statistic  df  n      p.value</span></span>
<span><span class="co">#&gt; 1  -0.53934161 0.80214778              t  0.3875493 131 NA 6.989785e-01</span></span>
<span><span class="co">#&gt; 2  -0.01567846 1.02343476              t  1.9185420 131 NA 5.721790e-02</span></span>
<span><span class="co">#&gt; 3   2.03091338 3.15798991              t  9.1075346 131 NA 1.228577e-15</span></span>
<span><span class="co">#&gt; 4  -0.73841845 0.60307095              t -0.1995913 131 NA 8.421097e-01</span></span>
<span><span class="co">#&gt; 5   0.24843358 1.34375508              t  2.8756205 131 NA 4.708061e-03</span></span>
<span><span class="co">#&gt; 6   1.85603680 3.14489812              t  7.6758004 131 NA 3.348520e-12</span></span>
<span><span class="co">#&gt; 7  -0.79296220 0.67656580              t -0.1566897 131 NA 8.757307e-01</span></span>
<span><span class="co">#&gt; 8   1.36063555 2.52239945              t  6.6119885 131 NA 8.752033e-10</span></span>
<span><span class="co">#&gt; 9  -1.54598050 0.09700175              t -1.7446479 131 NA 8.339142e-02</span></span>
<span><span class="co">#&gt; 10  0.56165177 1.76151636              t  3.8302495 131 NA 1.976376e-04</span></span>
<span><span class="co">#&gt;           p.adj signif model_type</span></span>
<span><span class="co">#&gt; 1  6.989785e-01  FALSE         lm</span></span>
<span><span class="co">#&gt; 2  1.144358e-01  FALSE         lm</span></span>
<span><span class="co">#&gt; 3  3.685731e-15   TRUE         lm</span></span>
<span><span class="co">#&gt; 4  8.421097e-01  FALSE         lm</span></span>
<span><span class="co">#&gt; 5  9.416121e-03   TRUE         lm</span></span>
<span><span class="co">#&gt; 6  1.004556e-11   TRUE         lm</span></span>
<span><span class="co">#&gt; 7  8.757307e-01  FALSE         lm</span></span>
<span><span class="co">#&gt; 8  1.750407e-09   TRUE         lm</span></span>
<span><span class="co">#&gt; 9  8.339142e-02  FALSE         lm</span></span>
<span><span class="co">#&gt; 10 3.952752e-04   TRUE         lm</span></span>
<span><span class="co">#&gt;                                                        formula weights</span></span>
<span><span class="co">#&gt; 1  I(post_vo2max_ml_min - pre_vo2max_ml_min) ~ age_group * sex    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2  I(post_vo2max_ml_min - pre_vo2max_ml_min) ~ age_group * sex    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3  I(post_vo2max_ml_min - pre_vo2max_ml_min) ~ age_group * sex    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4  I(post_vo2max_ml_min - pre_vo2max_ml_min) ~ age_group * sex    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5  I(post_vo2max_ml_min - pre_vo2max_ml_min) ~ age_group * sex    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6  I(post_vo2max_ml_min - pre_vo2max_ml_min) ~ age_group * sex    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 7  I(post_vo2max_ml_min - pre_vo2max_ml_min) ~ age_group * sex    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 8  I(post_vo2max_ml_min - pre_vo2max_ml_min) ~ age_group * sex    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 9  I(post_vo2max_ml_min - pre_vo2max_ml_min) ~ age_group * sex    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 10 I(post_vo2max_ml_min - pre_vo2max_ml_min) ~ age_group * sex    &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    obs_removed</span></span>
<span><span class="co">#&gt; 1         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 7         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 8         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 9         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 10        &lt;NA&gt;</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.0 (2024-04-24)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] rstatix_0.7.2                         </span></span>
<span><span class="co">#&gt;  [2] latex2exp_0.9.6                       </span></span>
<span><span class="co">#&gt;  [3] purrr_1.0.2                           </span></span>
<span><span class="co">#&gt;  [4] tidyr_1.3.1                           </span></span>
<span><span class="co">#&gt;  [5] tibble_3.2.1                          </span></span>
<span><span class="co">#&gt;  [6] emmeans_1.10.1                        </span></span>
<span><span class="co">#&gt;  [7] dplyr_1.1.4                           </span></span>
<span><span class="co">#&gt;  [8] MASS_7.3-60.2                         </span></span>
<span><span class="co">#&gt;  [9] ggplot2_3.5.1                         </span></span>
<span><span class="co">#&gt; [10] MotrpacRatTrainingPhysiologyData_2.0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gtable_0.3.5      beeswarm_0.4.0    xfun_0.43         bslib_0.7.0      </span></span>
<span><span class="co">#&gt;  [5] htmlwidgets_1.6.4 lattice_0.22-6    vctrs_0.6.5       tools_4.4.0      </span></span>
<span><span class="co">#&gt;  [9] generics_0.1.3    fansi_1.0.6       highr_0.10        pkgconfig_2.0.3  </span></span>
<span><span class="co">#&gt; [13] Matrix_1.7-0      desc_1.4.3        lifecycle_1.0.4   compiler_4.4.0   </span></span>
<span><span class="co">#&gt; [17] farver_2.1.1      stringr_1.5.1     textshaping_0.3.7 munsell_0.5.1    </span></span>
<span><span class="co">#&gt; [21] carData_3.0-5     vipor_0.4.7       htmltools_0.5.8.1 sass_0.4.9       </span></span>
<span><span class="co">#&gt; [25] yaml_2.3.8        pillar_1.9.0      pkgdown_2.0.9     car_3.1-2        </span></span>
<span><span class="co">#&gt; [29] ggpubr_0.6.0      jquerylib_0.1.4   cachem_1.0.8      abind_1.4-5      </span></span>
<span><span class="co">#&gt; [33] nlme_3.1-164      tidyselect_1.2.1  digest_0.6.35     mvtnorm_1.2-4    </span></span>
<span><span class="co">#&gt; [37] stringi_1.8.3     labeling_0.4.3    splines_4.4.0     fastmap_1.1.1    </span></span>
<span><span class="co">#&gt; [41] grid_4.4.0        colorspace_2.1-0  cli_3.6.2         magrittr_2.0.3   </span></span>
<span><span class="co">#&gt; [45] utf8_1.2.4        broom_1.0.5       withr_3.0.0       scales_1.3.0     </span></span>
<span><span class="co">#&gt; [49] backports_1.4.1   ggbeeswarm_0.7.2  estimability_1.5  rmarkdown_2.26   </span></span>
<span><span class="co">#&gt; [53] ggsignif_0.6.4    ragg_1.3.0        memoise_2.0.1     evaluate_0.23    </span></span>
<span><span class="co">#&gt; [57] knitr_1.46        mgcv_1.9-1        rlang_1.1.3       glue_1.7.0       </span></span>
<span><span class="co">#&gt; [61] jsonlite_1.8.8    R6_2.5.1          systemfonts_1.0.6 fs_1.6.4</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tyler J. Sagendorf.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
