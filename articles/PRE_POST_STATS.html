<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Statistical analyses of post- vs. pre-training body composition and VO2max testing measures • MotrpacRatTrainingPhysiologyData</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Statistical analyses of post- vs. pre-training body composition and VO2max testing measures">
<meta property="og:description" content="MotrpacRatTrainingPhysiologyData">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MotrpacRatTrainingPhysiologyData</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ANALYTES_STATS.html">Statistical analyses of plasma clinical analytes</a>
    </li>
    <li>
      <a href="../articles/BASELINE_STATS.html">Statistical analyses of baseline body composition and VO2max testing measures</a>
    </li>
    <li>
      <a href="../articles/FIBER_TYPES_STATS.html">Statistical analyses of mean fiber area and fiber count by muscle and fiber type</a>
    </li>
    <li>
      <a href="../articles/MUSCLES_STATS.html">Statistical analyses of muscle-specific measures</a>
    </li>
    <li>
      <a href="../articles/PRE_POST_STATS.html">Statistical analyses of post- vs. pre-training body composition and VO2max testing measures</a>
    </li>
    <li>
      <a href="../articles/analyte_plots.html">Plots of plasma clinical analytes</a>
    </li>
    <li>
      <a href="../articles/baseline_plots.html">Plots of baseline measures</a>
    </li>
    <li>
      <a href="../articles/fiber_type_plots.html">Plots of fiber area by muscle and fiber type</a>
    </li>
    <li>
      <a href="../articles/muscle_plots.html">Plots of muscle measures</a>
    </li>
    <li>
      <a href="../articles/pre_post_plots.html">Plots of post - pre differences</a>
    </li>
    <li>
      <a href="../articles/weekly_measures_plots.html">Plots of weekly body weight and blood lactate</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PNNL-Comp-Mass-Spec/MotrpacRatTrainingPhysiologyData/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Statistical analyses of post- vs. pre-training
body composition and VO2max testing measures</h1>
                        <h4 data-toc-skip class="author">Tyler
Sagendorf</h4>
            
            <h4 data-toc-skip class="date">15 July, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/PNNL-Comp-Mass-Spec/MotrpacRatTrainingPhysiologyData/blob/HEAD/vignettes/PRE_POST_STATS.Rmd" class="external-link"><code>vignettes/PRE_POST_STATS.Rmd</code></a></small>
      <div class="hidden name"><code>PRE_POST_STATS.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/PNNL-Comp-Mass-Spec/MotrpacRatTrainingPhysiologyData/" class="external-link">MotrpacRatTrainingPhysiologyData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/emmeans" class="external-link">emmeans</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stefanom.io/latex2exp/" class="external-link">latex2exp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/rstatix/" class="external-link">rstatix</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># base plot theme</span></span></code></pre></div>
<div class="section level2">
<h2 id="regression-models">Regression Models<a class="anchor" aria-label="anchor" href="#regression-models"></a>
</h2>
<p>We will fit linear regression models with age, sex, group, and their
interactions as predictors of the differences between post- and
pre-training values for different measures of body composition and
VO<span class="math inline">\(_2\)</span>max. If heteroscedasticity is
observed, we will include reciprocal group variances as weights. Certain
observations may be removed if their inclusion substantially affects the
model fit. Model parsimony will be achieved through ANOVA F-tests.</p>
<div class="section level3">
<h3 id="nmr-weight">NMR Weight<a class="anchor" aria-label="anchor" href="#nmr-weight"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot points</span></span>
<span><span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">post_weight</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">post_weight</span> <span class="op">-</span> <span class="va">pre_weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             na.rm <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NMR total body mass (post - pre)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>There is one negative outlying value in the 6M SED male group that
may affect the model fit. We will start with a WLS model, since we
observe different group variances.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt.weight</span> <span class="op">&lt;-</span> <span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">post_weight</span> <span class="op">-</span> <span class="va">pre_weight</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.weight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">post_weight</span> <span class="op">-</span> <span class="va">pre_weight</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">*</span> <span class="va">sex</span> <span class="op">*</span> <span class="va">group</span>,</span>
<span>                 weights <span class="op">=</span> <span class="va">wt.weight</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">NMR</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.weight</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>The diagnostic plots appear fine. We will try to simplify the
model.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.weight</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: I(post_weight - pre_weight)</span></span>
<span><span class="co">#&gt;                Df Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; age             1 227.94  227.94 227.9378 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; sex             1 490.51  490.51 490.5147 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; group           2  63.78   31.89  31.8906 2.099e-12 ***</span></span>
<span><span class="co">#&gt; age:sex         1  12.36   12.36  12.3552 0.0005704 ***</span></span>
<span><span class="co">#&gt; age:group       2  16.10    8.05   8.0491 0.0004648 ***</span></span>
<span><span class="co">#&gt; sex:group       2  53.63   26.81  26.8147 8.717e-11 ***</span></span>
<span><span class="co">#&gt; age:sex:group   2   2.76    1.38   1.3816 0.2541112    </span></span>
<span><span class="co">#&gt; Residuals     162 162.00    1.00                       </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>The 3-way interaction is not significant, so we will remove it.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.weight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fit.weight</span>, formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">age</span><span class="op">:</span><span class="va">sex</span><span class="op">:</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.weight</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit.weight</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = I(post_weight - pre_weight) ~ age + sex + group + </span></span>
<span><span class="co">#&gt;     age:sex + age:group + sex:group, data = NMR, weights = wt.weight)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Weighted Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.29096 -0.55221 -0.00037  0.68657  2.31574 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)       19.657      1.763  11.149  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; age18M           -22.194      2.555  -8.685 3.66e-15 ***</span></span>
<span><span class="co">#&gt; sexMale           -1.523      3.645  -0.418 0.676679    </span></span>
<span><span class="co">#&gt; group4W          -12.876      2.051  -6.279 2.94e-09 ***</span></span>
<span><span class="co">#&gt; group8W          -10.567      2.176  -4.856 2.78e-06 ***</span></span>
<span><span class="co">#&gt; age18M:sexMale   -15.378      2.645  -5.813 3.12e-08 ***</span></span>
<span><span class="co">#&gt; age18M:group4W    11.380      2.895   3.931 0.000124 ***</span></span>
<span><span class="co">#&gt; age18M:group8W     5.974      3.177   1.881 0.061804 .  </span></span>
<span><span class="co">#&gt; sexMale:group4W   -6.546      3.690  -1.774 0.077943 .  </span></span>
<span><span class="co">#&gt; sexMale:group8W  -23.491      3.764  -6.242 3.56e-09 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.002 on 164 degrees of freedom</span></span>
<span><span class="co">#&gt;   (108 observations deleted due to missingness)</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.8399, Adjusted R-squared:  0.8311 </span></span>
<span><span class="co">#&gt; F-statistic: 95.59 on 9 and 164 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="w-2w-terminal---pre-nmr-weight">1W, 2W: Terminal - Pre NMR Weight<a class="anchor" aria-label="anchor" href="#w-2w-terminal---pre-nmr-weight"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">term_nmr_df</span> <span class="op">&lt;-</span> <span class="va">WEIGHTS</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1W"</span>, <span class="st">"2W"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lm.ridge.html" class="external-link">select</a></span><span class="op">(</span><span class="va">pid</span>, <span class="va">iowa_id</span>, <span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span>, <span class="va">term_weight</span>, <span class="va">nmr_pre_weight</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">term_weight</span> <span class="op">-</span> <span class="va">nmr_pre_weight</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot points</span></span>
<span><span class="va">p_term</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">term_nmr_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"terminal - NMR weight (pre)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_term</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>There is an extreme observation in both 6M Male groups.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">term_nmr_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">nmr_pre_weight</span>, y <span class="op">=</span> <span class="va">term_weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-8-1.png" width="384"></p>
<p>We see the outlier in the 6M 2W male group is an outlier in the
scatterplot. We will plot the data without that observation.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove those two points and update the plot</span></span>
<span><span class="va">p_term</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">term_nmr_df</span>, <span class="va">diff</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">p_term</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<p>Nearly every group has at least one outlying sample, and the groups
have different variances. We will remove that extremely negative outlier
and fit a WLS model.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out.term_nmr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">term_nmr_df</span><span class="op">$</span><span class="va">diff</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">50</span><span class="op">)</span> <span class="co"># 58</span></span>
<span></span>
<span><span class="va">wt.term_nmr</span> <span class="op">&lt;-</span> <span class="va">term_nmr_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>term_weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">out.term_nmr</span>, </span>
<span>                              <span class="cn">NA</span>, <span class="va">term_weight</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">term_weight</span> <span class="op">-</span> <span class="va">nmr_pre_weight</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.term_nmr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">term_weight</span> <span class="op">-</span> <span class="va">nmr_pre_weight</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">*</span> <span class="va">sex</span> <span class="op">*</span> <span class="va">group</span>,</span>
<span>                   weights <span class="op">=</span> <span class="va">wt.term_nmr</span>,</span>
<span>                   subset <span class="op">=</span> <span class="op">-</span><span class="va">out.term_nmr</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">term_nmr_df</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.term_nmr</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>The diagnostic plots look mostly fine. We will try to simplify the
model.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.term_nmr</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: I(term_weight - nmr_pre_weight)</span></span>
<span><span class="co">#&gt;               Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; age            1  45.106  45.106  45.1065  1.19e-09 ***</span></span>
<span><span class="co">#&gt; sex            1 102.394 102.394 102.3936 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; group          1   7.376   7.376   7.3757  0.007803 ** </span></span>
<span><span class="co">#&gt; age:sex        1   4.468   4.468   4.4676  0.037056 *  </span></span>
<span><span class="co">#&gt; age:group      1   2.730   2.730   2.7302  0.101634    </span></span>
<span><span class="co">#&gt; sex:group      1   7.001   7.001   7.0007  0.009479 ** </span></span>
<span><span class="co">#&gt; age:sex:group  1   4.830   4.830   4.8301  0.030298 *  </span></span>
<span><span class="co">#&gt; Residuals     99  99.000   1.000                       </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>The 3-way interaction is significant, so we will not remove any
terms.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit.term_nmr</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = I(term_weight - nmr_pre_weight) ~ age * sex * group, </span></span>
<span><span class="co">#&gt;     data = term_nmr_df, subset = -out.term_nmr, weights = wt.term_nmr)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Weighted Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.1906 -0.5016 -0.0186  0.6069  3.1336 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)              -5.907      1.375  -4.295 4.08e-05 ***</span></span>
<span><span class="co">#&gt; age18M                   -1.810      2.066  -0.876 0.383085    </span></span>
<span><span class="co">#&gt; sexMale                  -3.069      2.157  -1.423 0.157982    </span></span>
<span><span class="co">#&gt; group2W                   3.127      1.937   1.614 0.109738    </span></span>
<span><span class="co">#&gt; age18M:sexMale           -9.706      3.474  -2.794 0.006254 ** </span></span>
<span><span class="co">#&gt; age18M:group2W           -8.043      2.792  -2.881 0.004861 ** </span></span>
<span><span class="co">#&gt; sexMale:group2W          -9.844      2.862  -3.439 0.000854 ***</span></span>
<span><span class="co">#&gt; age18M:sexMale:group2W    9.752      4.437   2.198 0.030298 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1 on 99 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.6372, Adjusted R-squared:  0.6116 </span></span>
<span><span class="co">#&gt; F-statistic: 24.84 on 7 and 99 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="nmr-lean-mass">NMR Lean Mass<a class="anchor" aria-label="anchor" href="#nmr-lean-mass"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot points</span></span>
<span><span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">post_lean</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">post_lean</span> <span class="op">-</span> <span class="va">pre_lean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             na.rm <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NMR lean mass (post - pre)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p>We observe several outlying values in several of the 6M male groups,
as well as in 18M 8W males.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.lean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">post_lean</span> <span class="op">-</span> <span class="va">pre_lean</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">*</span> <span class="va">sex</span> <span class="op">*</span> <span class="va">group</span>,</span>
<span>               data <span class="op">=</span> <span class="va">NMR</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.lean</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<p>Observations 80 and 140 are outlying, and greatly impact group
variances. We will try WLS.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NMR</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">140</span><span class="op">)</span>, <span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lm.ridge.html" class="external-link">select</a></span><span class="op">(</span><span class="va">pid</span>, <span class="va">iowa_id</span>, <span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span>, <span class="va">pre_lean</span>, <span class="va">post_lean</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">post_lean</span> <span class="op">-</span> <span class="va">pre_lean</span><span class="op">)</span></span>
<span><span class="co">#&gt;          pid iowa_id age  sex group pre_lean post_lean     diff</span></span>
<span><span class="co">#&gt; 80  10023259  06M8T1  6M Male   SED 188.9168  211.8662  22.9494</span></span>
<span><span class="co">#&gt; 140 10024735  06M8T3  6M Male    8W 188.7944  172.4344 -16.3600</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt.lean</span> <span class="op">&lt;-</span> <span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">post_lean</span> <span class="op">-</span> <span class="va">pre_lean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.lean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fit.lean</span>, weights <span class="op">=</span> <span class="va">wt.lean</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.lean</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
<p>The diagnostic plots seem mostly fine. We will try to simplify the
model.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.lean</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: I(post_lean - pre_lean)</span></span>
<span><span class="co">#&gt;                Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; age             1  28.621  28.621  28.6208  2.96e-07 ***</span></span>
<span><span class="co">#&gt; sex             1 202.760 202.760 202.7598 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; group           2 116.781  58.391  58.3906 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; age:sex         1  10.537  10.537  10.5371  0.001422 ** </span></span>
<span><span class="co">#&gt; age:group       2   4.869   2.434   2.4343  0.090860 .  </span></span>
<span><span class="co">#&gt; sex:group       2  14.179   7.089   7.0894  0.001118 ** </span></span>
<span><span class="co">#&gt; age:sex:group   2   3.589   1.794   1.7944  0.169509    </span></span>
<span><span class="co">#&gt; Residuals     162 162.000   1.000                       </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.lean.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fit.lean</span>, formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">*</span> <span class="op">(</span><span class="va">age</span> <span class="op">+</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit.lean.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fit.lean.1</span>, formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">age</span><span class="op">:</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.lean.1</span>, <span class="va">fit.lean.2</span>, <span class="va">fit.lean</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model 1: I(post_lean - pre_lean) ~ sex + age + group + sex:age + sex:group</span></span>
<span><span class="co">#&gt; Model 2: I(post_lean - pre_lean) ~ sex + age + group + sex:age + sex:group + </span></span>
<span><span class="co">#&gt;     age:group</span></span>
<span><span class="co">#&gt; Model 3: I(post_lean - pre_lean) ~ age * sex * group</span></span>
<span><span class="co">#&gt;   Res.Df    RSS Df Sum of Sq      F  Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; 1    166 172.88                              </span></span>
<span><span class="co">#&gt; 2    164 165.59  2    7.2930 3.6465 0.02825 *</span></span>
<span><span class="co">#&gt; 3    162 162.00  2    3.5889 1.7944 0.16951  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>There is no significant difference between the second and third
models, so we will use the simpler one.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.lean</span> <span class="op">&lt;-</span> <span class="va">fit.lean.2</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.lean</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit.lean</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = I(post_lean - pre_lean) ~ sex + age + group + sex:age + </span></span>
<span><span class="co">#&gt;     sex:group + age:group, data = NMR, weights = wt.lean)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Weighted Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.3795 -0.4853 -0.0457  0.5679  3.0351 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)      -4.9746     0.8038  -6.189 4.68e-09 ***</span></span>
<span><span class="co">#&gt; sexMale           3.7435     1.6736   2.237 0.026646 *  </span></span>
<span><span class="co">#&gt; age18M           -1.5264     0.9812  -1.556 0.121707    </span></span>
<span><span class="co">#&gt; group4W           7.5303     1.0137   7.428 5.72e-12 ***</span></span>
<span><span class="co">#&gt; group8W           6.6716     1.1186   5.964 1.46e-08 ***</span></span>
<span><span class="co">#&gt; sexMale:age18M    4.3465     1.3856   3.137 0.002025 ** </span></span>
<span><span class="co">#&gt; sexMale:group4W   1.1925     1.6630   0.717 0.474337    </span></span>
<span><span class="co">#&gt; sexMale:group8W   6.5600     1.9305   3.398 0.000852 ***</span></span>
<span><span class="co">#&gt; age18M:group4W   -2.4403     1.2295  -1.985 0.048847 *  </span></span>
<span><span class="co">#&gt; age18M:group8W   -3.8426     1.4920  -2.575 0.010894 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.005 on 164 degrees of freedom</span></span>
<span><span class="co">#&gt;   (108 observations deleted due to missingness)</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.6952, Adjusted R-squared:  0.6785 </span></span>
<span><span class="co">#&gt; F-statistic: 41.57 on 9 and 164 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="nmr-fat-mass">NMR Fat Mass<a class="anchor" aria-label="anchor" href="#nmr-fat-mass"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot points</span></span>
<span><span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">post_fat</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">post_fat</span> <span class="op">-</span> <span class="va">pre_fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             na.rm <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NMR fat mass (post - pre)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
<p>We observe unequal group variances, and several outlying values
(especially in the 6M 4W male group). We will fit a WLS model with
reciprocal group variances as weights.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt.fat</span> <span class="op">&lt;-</span> <span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">post_fat</span> <span class="op">-</span> <span class="va">pre_fat</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.fat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">post_fat</span> <span class="op">-</span> <span class="va">pre_fat</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">*</span> <span class="va">sex</span> <span class="op">*</span> <span class="va">group</span>,</span>
<span>              weights <span class="op">=</span> <span class="va">wt.fat</span>,</span>
<span>              data <span class="op">=</span> <span class="va">NMR</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.fat</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
<p>The diagnostic plots seem mostly fine. We will try to simplify the
model.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.fat</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: I(post_fat - pre_fat)</span></span>
<span><span class="co">#&gt;                Df Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; age             1  95.84   95.84  95.8358 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; sex             1 335.44  335.44 335.4412 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; group           2 194.96   97.48  97.4800 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; age:sex         1   0.21    0.21   0.2081 0.6488718    </span></span>
<span><span class="co">#&gt; age:group       2  17.32    8.66   8.6593 0.0002673 ***</span></span>
<span><span class="co">#&gt; sex:group       2  94.30   47.15  47.1524 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; age:sex:group   2   1.30    0.65   0.6485 0.5241943    </span></span>
<span><span class="co">#&gt; Residuals     162 162.00    1.00                       </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>We will remove the 3-way interaction and the <code>sex:age</code>
interaction.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fit.fat</span>, formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">group</span> <span class="op">*</span> <span class="op">(</span><span class="va">sex</span> <span class="op">+</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.1</span>, <span class="va">fit.fat</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model 1: I(post_fat - pre_fat) ~ group + sex + age + group:sex + group:age</span></span>
<span><span class="co">#&gt; Model 2: I(post_fat - pre_fat) ~ age * sex * group</span></span>
<span><span class="co">#&gt;   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)</span></span>
<span><span class="co">#&gt; 1    165 163.85                           </span></span>
<span><span class="co">#&gt; 2    162 162.00  3    1.8466 0.6155 0.6059</span></span></code></pre></div>
<p>There is no significant difference between the models, so we will use
the simpler one.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.fat</span> <span class="op">&lt;-</span> <span class="va">fit.1</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.fat</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-25-1.png" width="672"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit.fat</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = I(post_fat - pre_fat) ~ group + sex + age + group:sex + </span></span>
<span><span class="co">#&gt;     group:age, data = NMR, weights = wt.fat)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Weighted Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -2.4813 -0.6232 -0.0018  0.4985  3.0679 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)       5.5293     0.5677   9.740  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; group4W          -6.2398     0.6957  -8.969 6.33e-16 ***</span></span>
<span><span class="co">#&gt; group8W          -5.6441     0.8608  -6.557 6.74e-10 ***</span></span>
<span><span class="co">#&gt; sexMale          -2.0273     1.1535  -1.757 0.080690 .  </span></span>
<span><span class="co">#&gt; age18M           -8.4595     1.0712  -7.897 3.79e-13 ***</span></span>
<span><span class="co">#&gt; group4W:sexMale  -5.3791     1.5854  -3.393 0.000866 ***</span></span>
<span><span class="co">#&gt; group8W:sexMale -13.8861     1.4743  -9.419  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; group4W:age18M    5.4420     1.2157   4.476 1.41e-05 ***</span></span>
<span><span class="co">#&gt; group8W:age18M    3.5740     1.4658   2.438 0.015822 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.9965 on 165 degrees of freedom</span></span>
<span><span class="co">#&gt;   (108 observations deleted due to missingness)</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.8182, Adjusted R-squared:  0.8094 </span></span>
<span><span class="co">#&gt; F-statistic: 92.84 on 8 and 165 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="nmr-lean-mass-1">NMR % Lean Mass<a class="anchor" aria-label="anchor" href="#nmr-lean-mass-1"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot points</span></span>
<span><span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">post_lean_pct</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">post_lean_pct</span> <span class="op">-</span> <span class="va">pre_lean_pct</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             na.rm <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NMR % lean mass (post - pre)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-27-1.png" width="672"></p>
<p>We observe several outlying values in several of the 6M male groups,
similar to the plot of the differences in lean mass. We also observe
unequal group variances, so we will fit a WLS model with reciprocal
group variances as weights.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt.lean_pct</span> <span class="op">&lt;-</span> <span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sex</span>, <span class="va">group</span>, <span class="va">age</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">post_lean_pct</span> <span class="op">-</span> <span class="va">pre_lean_pct</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.lean_pct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">post_lean_pct</span> <span class="op">-</span> <span class="va">pre_lean_pct</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">*</span> <span class="va">sex</span> <span class="op">*</span> <span class="va">group</span>,</span>
<span>                   weights <span class="op">=</span> <span class="va">wt.lean_pct</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">NMR</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.lean_pct</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-28-1.png" width="672"></p>
<p>The diagnostic plots look mostly fine. We will try to simplify the
model.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.lean_pct</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: I(post_lean_pct - pre_lean_pct)</span></span>
<span><span class="co">#&gt;                Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; age             1  16.900  16.900  16.9003 6.246e-05 ***</span></span>
<span><span class="co">#&gt; sex             1 222.038 222.038 222.0380 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; group           2 113.016  56.508  56.5079 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; age:sex         1   6.648   6.648   6.6481  0.010816 *  </span></span>
<span><span class="co">#&gt; age:group       2  12.336   6.168   6.1679  0.002621 ** </span></span>
<span><span class="co">#&gt; sex:group       2  11.304   5.652   5.6519  0.004239 ** </span></span>
<span><span class="co">#&gt; age:sex:group   2   4.490   2.245   2.2451  0.109202    </span></span>
<span><span class="co">#&gt; Residuals     162 162.000   1.000                       </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>We will remove the 3-way interaction.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.lean_pct.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fit.lean_pct</span>, formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">sex</span><span class="op">:</span><span class="va">group</span><span class="op">:</span><span class="va">age</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.lean_pct.1</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-30-1.png" width="672"></p>
<p>The QQ-plot looks slightly worse, so we will retain all terms.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit.lean_pct</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = I(post_lean_pct - pre_lean_pct) ~ age * sex * group, </span></span>
<span><span class="co">#&gt;     data = NMR, weights = wt.lean_pct)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Weighted Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.99876 -0.50801 -0.02364  0.59012  2.92545 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)             -2.8167     0.4417  -6.376 1.81e-09 ***</span></span>
<span><span class="co">#&gt; age18M                   0.1667     0.5100   0.327 0.744229    </span></span>
<span><span class="co">#&gt; sexMale                  2.7167     0.8199   3.313 0.001137 ** </span></span>
<span><span class="co">#&gt; group4W                  4.1067     0.5736   7.159 2.68e-11 ***</span></span>
<span><span class="co">#&gt; group8W                  3.9637     0.6313   6.278 3.02e-09 ***</span></span>
<span><span class="co">#&gt; age18M:sexMale           0.1879     0.9243   0.203 0.839184    </span></span>
<span><span class="co">#&gt; age18M:group4W          -2.0317     0.6665  -3.048 0.002690 ** </span></span>
<span><span class="co">#&gt; age18M:group8W          -3.0637     0.7886  -3.885 0.000149 ***</span></span>
<span><span class="co">#&gt; sexMale:group4W         -1.4956     0.9676  -1.546 0.124159    </span></span>
<span><span class="co">#&gt; sexMale:group8W         -1.1945     1.1742  -1.017 0.310551    </span></span>
<span><span class="co">#&gt; age18M:sexMale:group4W   0.8874     1.1120   0.798 0.426026    </span></span>
<span><span class="co">#&gt; age18M:sexMale:group8W   2.7733     1.3421   2.066 0.040385 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1 on 162 degrees of freedom</span></span>
<span><span class="co">#&gt;   (108 observations deleted due to missingness)</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.7048, Adjusted R-squared:  0.6847 </span></span>
<span><span class="co">#&gt; F-statistic: 35.16 on 11 and 162 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="nmr-fat-mass-1">NMR % Fat Mass<a class="anchor" aria-label="anchor" href="#nmr-fat-mass-1"></a>
</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot points</span></span>
<span><span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">post_fat_pct</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">post_fat_pct</span> <span class="op">-</span> <span class="va">pre_fat_pct</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             na.rm <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"NMR % fat mass (post - pre)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-32-1.png" width="672"></p>
<p>There are several groups with outlying values: mainly, two from the
6M 4W males and one from the 18M 8W females. We will try an OLS model
first.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.fat_pct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">post_fat_pct</span> <span class="op">-</span> <span class="va">pre_fat_pct</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">*</span> <span class="va">sex</span> <span class="op">*</span> <span class="va">group</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">NMR</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.fat_pct</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-33-1.png" width="672"></p>
<p>Those extreme values are being flagged in the diagnostic plots.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NMR</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">136</span>, <span class="fl">138</span>, <span class="fl">218</span><span class="op">)</span>, <span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lm.ridge.html" class="external-link">select</a></span><span class="op">(</span><span class="va">pid</span>, <span class="va">iowa_id</span>, <span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span>, <span class="va">post_fat_pct</span>, <span class="va">pre_fat_pct</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">post_fat_pct</span> <span class="op">-</span> <span class="va">pre_fat_pct</span><span class="op">)</span></span>
<span><span class="co">#&gt;          pid iowa_id age    sex group post_fat_pct pre_fat_pct diff</span></span>
<span><span class="co">#&gt; 136 10185585 06M4T17  6M   Male    4W         15.4        12.2  3.2</span></span>
<span><span class="co">#&gt; 138 10219315 06M4T19  6M   Male    4W         10.1        17.9 -7.8</span></span>
<span><span class="co">#&gt; 218 11623578 18F8T29 18M Female    8W         17.9        14.3  3.6</span></span></code></pre></div>
<p>The two outliers in the 6M 4W male group are about equidistant from
the mean of the other values, so their removal will only shrink the
variance of the group. Removal of the 18M 8W female sample, however,
will reduce the variance and shift the mean away from 0. We will try a
WLS model and remove these observations, since they have a huge impact
on the group variances and would shift the right tail of the QQ-plot if
they were included.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We will remove these values, but keep the rows.</span></span>
<span><span class="co"># This is so we can use the subset argument in update, which</span></span>
<span><span class="co"># is easier to keep track of when we extract model info later.</span></span>
<span><span class="va">wt.fat_pct</span> <span class="op">&lt;-</span> <span class="va">NMR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>idx <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>         post_fat_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">idx</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">136</span>, <span class="fl">138</span>, <span class="fl">218</span><span class="op">)</span>, </span>
<span>                               <span class="cn">NA</span>, <span class="va">post_fat_pct</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">post_fat_pct</span> <span class="op">-</span> <span class="va">pre_fat_pct</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.fat_pct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fit.fat_pct</span>, </span>
<span>                      subset <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">136</span>, <span class="fl">138</span>, <span class="fl">218</span><span class="op">)</span>, </span>
<span>                      weights <span class="op">=</span> <span class="va">wt.fat_pct</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.fat_pct</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-35-1.png" width="672"></p>
<p>The diagnostic plots look fine. We will try to simplify the
model.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.fat_pct</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: I(post_fat_pct - pre_fat_pct)</span></span>
<span><span class="co">#&gt;                Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; age             1  47.211  47.211  47.2106 1.366e-10 ***</span></span>
<span><span class="co">#&gt; sex             1 197.607 197.607 197.6068 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; group           2 269.226 134.613 134.6130 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; age:sex         1  11.809  11.809  11.8088 0.0007523 ***</span></span>
<span><span class="co">#&gt; age:group       2  34.278  17.139  17.1388 1.818e-07 ***</span></span>
<span><span class="co">#&gt; sex:group       2  32.821  16.411  16.4107 3.317e-07 ***</span></span>
<span><span class="co">#&gt; age:sex:group   2   5.052   2.526   2.5258 0.0831965 .  </span></span>
<span><span class="co">#&gt; Residuals     159 159.000   1.000                       </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>We will remove the 3-way interaction.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.fat_pct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fit.fat_pct</span>, formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">age</span><span class="op">:</span><span class="va">sex</span><span class="op">:</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.fat_pct</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-37-1.png" width="672"></p>
<p>The diagnostic plots still look fine.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit.fat_pct</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = I(post_fat_pct - pre_fat_pct) ~ age + sex + group + </span></span>
<span><span class="co">#&gt;     age:sex + age:group + sex:group, data = NMR, subset = -c(136, </span></span>
<span><span class="co">#&gt;     138, 218), weights = wt.fat_pct)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Weighted Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.48444 -0.64666 -0.03925  0.57976  2.42922 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)       3.0417     0.3060   9.941  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; age18M           -4.0871     0.4308  -9.487  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; sexMale          -1.8361     0.4104  -4.474 1.45e-05 ***</span></span>
<span><span class="co">#&gt; group4W          -3.3109     0.3623  -9.138 2.62e-16 ***</span></span>
<span><span class="co">#&gt; group8W          -3.4846     0.4320  -8.066 1.57e-13 ***</span></span>
<span><span class="co">#&gt; age18M:sexMale    1.4599     0.3508   4.162 5.12e-05 ***</span></span>
<span><span class="co">#&gt; age18M:group4W    2.6597     0.4649   5.721 5.04e-08 ***</span></span>
<span><span class="co">#&gt; age18M:group8W    2.2262     0.5020   4.435 1.70e-05 ***</span></span>
<span><span class="co">#&gt; sexMale:group4W  -0.3666     0.4612  -0.795    0.428    </span></span>
<span><span class="co">#&gt; sexMale:group8W  -2.3718     0.4976  -4.766 4.17e-06 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.009 on 161 degrees of freedom</span></span>
<span><span class="co">#&gt;   (108 observations deleted due to missingness)</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.7833, Adjusted R-squared:  0.7712 </span></span>
<span><span class="co">#&gt; F-statistic: 64.66 on 9 and 161 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="absolute-vo_2max">Absolute VO<span class="math inline">\(_2\)</span>max<a class="anchor" aria-label="anchor" href="#absolute-vo_2max"></a>
</h3>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot points</span></span>
<span><span class="va">VO2MAX</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">post_vo2max_ml_min</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">post_vo2max_ml_min</span> <span class="op">-</span> <span class="va">pre_vo2max_ml_min</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             na.rm <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html" class="external-link">TeX</a></span><span class="op">(</span><span class="st">"Absolute VO$_2$max (post - pre)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-39-1.png" width="672"></p>
<p>Several groups have both large and small outlying values. Namely, 6M
SED and 4W males and 18M SED females. Also, we do not have data for the
18M 4W groups of either sex, so certain coefficients will be
inestimable. To handle this, we will combine age and group into a single
factor.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Concatenate age and group</span></span>
<span><span class="va">VO2MAX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">VO2MAX</span>, age_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">age</span>, <span class="st">"_"</span>, <span class="va">group</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.vo2max_abs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">post_vo2max_ml_min</span> <span class="op">-</span> <span class="va">pre_vo2max_ml_min</span><span class="op">)</span> <span class="op">~</span> </span>
<span>                       <span class="va">age_group</span> <span class="op">*</span> <span class="va">sex</span>,</span>
<span>                     data <span class="op">=</span> <span class="va">VO2MAX</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.vo2max_abs</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-40-1.png" width="672"></p>
<p>The diagnostic plots look mostly fine. We will try to simplify the
model.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.vo2max_abs</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: I(post_vo2max_ml_min - pre_vo2max_ml_min)</span></span>
<span><span class="co">#&gt;                Df  Sum Sq Mean Sq F value Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; age_group       4 157.901  39.475 27.6274 &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; sex             1   0.977   0.977  0.6836 0.4099    </span></span>
<span><span class="co">#&gt; age_group:sex   4   4.952   1.238  0.8665 0.4860    </span></span>
<span><span class="co">#&gt; Residuals     131 187.179   1.429                   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.vo2max_abs.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fit.vo2max_abs</span>, formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">age_group</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.vo2max_abs.1</span>, <span class="va">fit.vo2max_abs</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model 1: I(post_vo2max_ml_min - pre_vo2max_ml_min) ~ age_group</span></span>
<span><span class="co">#&gt; Model 2: I(post_vo2max_ml_min - pre_vo2max_ml_min) ~ age_group * sex</span></span>
<span><span class="co">#&gt;   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)</span></span>
<span><span class="co">#&gt; 1    136 193.11                           </span></span>
<span><span class="co">#&gt; 2    131 187.18  5    5.9291 0.8299 0.5306</span></span></code></pre></div>
<p>There is no significant difference between the models, so we will use
the simpler one.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.vo2max_abs</span> <span class="op">&lt;-</span> <span class="va">fit.vo2max_abs.1</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.vo2max_abs</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-43-1.png" width="672"></p>
<p>The diagnostic plots look fine.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit.vo2max_abs</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = I(post_vo2max_ml_min - pre_vo2max_ml_min) ~ age_group, </span></span>
<span><span class="co">#&gt;     data = VO2MAX)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.7503 -0.7707 -0.0559  0.7447  3.6341 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)        1.5641     0.2140   7.308 2.08e-11 ***</span></span>
<span><span class="co">#&gt; age_group18M_SED  -2.2021     0.3531  -6.236 5.28e-09 ***</span></span>
<span><span class="co">#&gt; age_group6M_4W    -0.9218     0.2884  -3.196  0.00173 ** </span></span>
<span><span class="co">#&gt; age_group6M_8W     0.9896     0.3052   3.243  0.00149 ** </span></span>
<span><span class="co">#&gt; age_group6M_SED   -1.5323     0.3240  -4.729 5.56e-06 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.192 on 136 degrees of freedom</span></span>
<span><span class="co">#&gt;   (93 observations deleted due to missingness)</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.4498, Adjusted R-squared:  0.4337 </span></span>
<span><span class="co">#&gt; F-statistic:  27.8 on 4 and 136 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="vo_2max-relative-to-total-body-mass">VO<span class="math inline">\(_2\)</span>max (relative to total body
mass)<a class="anchor" aria-label="anchor" href="#vo_2max-relative-to-total-body-mass"></a>
</h3>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot points</span></span>
<span><span class="va">VO2MAX</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">post_vo2max_ml_kg_min</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, </span>
<span>             y <span class="op">=</span> <span class="va">post_vo2max_ml_kg_min</span> <span class="op">-</span> <span class="va">pre_vo2max_ml_kg_min</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             na.rm <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Relative VO2max (post - pre)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-45-1.png" width="672"></p>
<p>There is an outlying sample in the 18M SED female group.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.vo2max_rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">post_vo2max_ml_kg_min</span> <span class="op">-</span> <span class="va">pre_vo2max_ml_kg_min</span><span class="op">)</span> <span class="op">~</span> </span>
<span>                       <span class="va">age_group</span> <span class="op">*</span> <span class="va">sex</span>,</span>
<span>                     data <span class="op">=</span> <span class="va">VO2MAX</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.vo2max_rel</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-46-1.png" width="672"></p>
<p>The diagnostic plots look mostly fine, though we observe unequal
group variances. We will try a WLS model.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt.vo2max_rel</span> <span class="op">&lt;-</span> <span class="va">VO2MAX</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="va">sex</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">post_vo2max_ml_kg_min</span> <span class="op">-</span> <span class="va">pre_vo2max_ml_kg_min</span>,</span>
<span>                 na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.vo2max_rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fit.vo2max_rel</span>, weights <span class="op">=</span> <span class="va">wt.vo2max_rel</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.vo2max_rel</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-47-1.png" width="672"></p>
<p>The diagnostic plots look a bit better, and the mean-variance
relationship appears constant. We will try to simplify the model.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.vo2max_rel</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: I(post_vo2max_ml_kg_min - pre_vo2max_ml_kg_min)</span></span>
<span><span class="co">#&gt;                Df  Sum Sq Mean Sq F value Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; age_group       4 228.913  57.228 57.2284 &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; sex             1   1.270   1.270  1.2704 0.2618    </span></span>
<span><span class="co">#&gt; age_group:sex   4   5.132   1.283  1.2829 0.2800    </span></span>
<span><span class="co">#&gt; Residuals     131 131.000   1.000                   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.vo2max_rel.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fit.vo2max_rel</span>, formula <span class="op">=</span> <span class="va">.</span> <span class="op">~</span> <span class="va">age_group</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit.vo2max_rel.1</span>, <span class="va">fit.vo2max_rel</span>, test <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model 1: I(post_vo2max_ml_kg_min - pre_vo2max_ml_kg_min) ~ age_group</span></span>
<span><span class="co">#&gt; Model 2: I(post_vo2max_ml_kg_min - pre_vo2max_ml_kg_min) ~ age_group * </span></span>
<span><span class="co">#&gt;     sex</span></span>
<span><span class="co">#&gt;   Res.Df   RSS Df Sum of Sq      F Pr(&gt;F)</span></span>
<span><span class="co">#&gt; 1    136 137.4                           </span></span>
<span><span class="co">#&gt; 2    131 131.0  5    6.4021 1.2804 0.2762</span></span></code></pre></div>
<p>There is no significant difference between the models, so we will use
the simpler one.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.vo2max_rel</span> <span class="op">&lt;-</span> <span class="va">fit.vo2max_rel.1</span> </span>
<span><span class="fu"><a href="../reference/plot_lm.html">plot_lm</a></span><span class="op">(</span><span class="va">fit.vo2max_rel</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-50-1.png" width="672"></p>
<p>The diagnostic plots look about the same.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit.vo2max_rel</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = I(post_vo2max_ml_kg_min - pre_vo2max_ml_kg_min) ~ </span></span>
<span><span class="co">#&gt;     age_group, data = VO2MAX, weights = wt.vo2max_rel)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Weighted Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.0983 -0.7180 -0.1406  0.6170  2.4047 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)        9.0097     0.6537  13.782  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; age_group18M_SED  -9.5178     1.0111  -9.413  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; age_group6M_4W    -6.6448     0.8319  -7.987 5.21e-13 ***</span></span>
<span><span class="co">#&gt; age_group6M_8W     1.7430     1.1310   1.541    0.126    </span></span>
<span><span class="co">#&gt; age_group6M_SED  -13.4094     1.1939 -11.232  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.005 on 136 degrees of freedom</span></span>
<span><span class="co">#&gt;   (93 observations deleted due to missingness)</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.6249, Adjusted R-squared:  0.6139 </span></span>
<span><span class="co">#&gt; F-statistic: 56.64 on 4 and 136 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="maximum-run-speed">Maximum Run Speed<a class="anchor" aria-label="anchor" href="#maximum-run-speed"></a>
</h3>
<p>Since run speed was increased in 1.8 m/min increments, as defined in
the training protocol, it may be better to use a non-parametric test.
Rather than plotting the individual points for the differences, since
they can only take on a few different values, we will instead count the
number of samples that take on a particular value in each group and
scale the points accordingly.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot points</span></span>
<span><span class="va">VO2MAX</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">post_speed_max</span> <span class="op">-</span> <span class="va">pre_speed_max</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span>, <span class="va">diff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">diff</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size_area</a></span><span class="op">(</span>max_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Maximum Run Speed (post - pre)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PRE_POST_STATS_files/figure-html/unnamed-chunk-52-1.png" width="672"></p>
<p>Most groups only take on 4 or 5 different values. We will use
Wilcoxon Rank Sum tests to compare each trained group to their matching
control group. We will adjust p-values within each age and sex group
after we set up comparisons for all measures.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Testing the differences is equivalent to a paired test</span></span>
<span><span class="va">speed_res</span> <span class="op">&lt;-</span> <span class="va">VO2MAX</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">post_speed_max</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>speed_diff <span class="op">=</span> <span class="va">post_speed_max</span> <span class="op">-</span> <span class="va">pre_speed_max</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/wilcox_test.html" class="external-link">wilcox_test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">speed_diff</span> <span class="op">~</span> <span class="fl">1</span>, mu <span class="op">=</span> <span class="fl">0</span>,</span>
<span>              detailed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              p.adjust.method <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>p.value <span class="op">=</span> <span class="va">p</span>,</span>
<span>                lower.CL <span class="op">=</span> <span class="va">conf.low</span>, </span>
<span>                upper.CL <span class="op">=</span> <span class="va">conf.high</span>,</span>
<span>                W.ratio <span class="op">=</span> <span class="va">statistic</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, </span>
<span>                <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.nan</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span>, <span class="va">estimate</span>, <span class="va">lower.CL</span>, <span class="va">upper.CL</span>,</span>
<span>                <span class="va">n</span>, <span class="va">W.ratio</span>, <span class="va">p.value</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="comparisons">Comparisons<a class="anchor" aria-label="anchor" href="#comparisons"></a>
</h2>
<p>We will test if group means are different from 0 and adjust p-values
using the Holm procedure within each combination of sex and age.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We will include the maximum run speed test results at the end</span></span>
<span><span class="va">model_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"NMR Weight"</span> <span class="op">=</span> <span class="va">fit.weight</span>,</span>
<span>                   <span class="st">"Term - NMR Pre Weight"</span> <span class="op">=</span> <span class="va">fit.term_nmr</span>,</span>
<span>                   <span class="st">"NMR Lean Mass"</span> <span class="op">=</span> <span class="va">fit.lean</span>,</span>
<span>                   <span class="st">"NMR Fat Mass"</span> <span class="op">=</span> <span class="va">fit.fat</span>,</span>
<span>                   <span class="st">"NMR % Lean"</span> <span class="op">=</span> <span class="va">fit.lean_pct</span>,</span>
<span>                   <span class="st">"NMR % Fat"</span> <span class="op">=</span> <span class="va">fit.fat_pct</span>,</span>
<span>                   <span class="st">"Absolute VO2max"</span> <span class="op">=</span> <span class="va">fit.vo2max_abs</span>,</span>
<span>                   <span class="st">"Relative VO2max"</span> <span class="op">=</span> <span class="va">fit.vo2max_rel</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract model info</span></span>
<span><span class="va">model_df</span> <span class="op">&lt;-</span> <span class="va">model_list</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_chr</a></span><span class="op">(</span>.f <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="va">.x</span><span class="op">[[</span><span class="st">"call"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">enframe</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"response"</span>, </span>
<span>          value <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"(?&lt;=[\\s])\\s*|^\\s+|\\s+$"</span>, <span class="st">""</span>, <span class="va">model</span>, perl <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>         model_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^([^\\(]+).*"</span>, <span class="st">"\\1"</span>, <span class="va">model</span><span class="op">)</span>,</span>
<span>         formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">".*formula = ([^,]+),.*"</span>, <span class="st">"\\1"</span>, <span class="va">model</span><span class="op">)</span>,</span>
<span>         family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">".*family = ([^\\)]+\\)),.*"</span>, <span class="st">"\\1"</span>, <span class="va">model</span><span class="op">)</span>,</span>
<span>         family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">model_type</span> <span class="op">==</span> <span class="st">"lm"</span>, <span class="st">"gaussian"</span>, <span class="va">family</span><span class="op">)</span>,</span>
<span>         <span class="co"># if weights were used, they were reciprocal group variances</span></span>
<span>         weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"weights = "</span>, <span class="va">model</span><span class="op">)</span>, </span>
<span>                          <span class="st">"reciprocal group variances"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">model</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>obs_removed <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">response</span> <span class="op">==</span> <span class="st">"Term - NMR Pre Weight"</span> <span class="op">~</span> <span class="va">NMR</span><span class="op">$</span><span class="va">iowa_id</span><span class="op">[</span><span class="fl">58</span><span class="op">]</span>,</span>
<span>    <span class="va">response</span> <span class="op">==</span> <span class="st">"NMR % Fat"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">NMR</span><span class="op">$</span><span class="va">iowa_id</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">136</span>, <span class="fl">138</span>, <span class="fl">218</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                    collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimated marginal means</span></span>
<span><span class="va">PRE_POST_STATS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">model_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">mod_i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">terms_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/terms.html" class="external-link">terms</a></span><span class="op">(</span><span class="va">mod_i</span><span class="op">)</span>, which <span class="op">=</span> <span class="st">"term.labels"</span><span class="op">)</span></span>
<span>  <span class="va">specs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age_group"</span>, <span class="st">"group"</span><span class="op">)</span>, <span class="va">terms_i</span><span class="op">)</span></span>
<span>  <span class="va">by</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"sex"</span><span class="op">)</span>, <span class="va">terms_i</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">by</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">by</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html" class="external-link">emmeans</a></span><span class="op">(</span><span class="va">mod_i</span>, specs <span class="op">=</span> <span class="va">specs</span>, by <span class="op">=</span> <span class="va">by</span>, infer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">specs</span> <span class="op">==</span> <span class="st">"age_group"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>                  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"_.*"</span>, <span class="st">""</span>, <span class="va">age_group</span><span class="op">)</span>,</span>
<span>                  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">".*_"</span>, <span class="st">""</span>, <span class="va">age_group</span><span class="op">)</span>,</span>
<span>                  age_group <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Include maximum run speed results</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Maximum Run Speed"</span> <span class="op">=</span> <span class="va">speed_res</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">enframe</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p.value</span>, method <span class="op">=</span> <span class="st">"holm"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>signif <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">p.value</span>, </span>
<span>                      breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"***"</span>, <span class="st">"**"</span>, <span class="st">"*"</span>, <span class="st">""</span><span class="op">)</span>,</span>
<span>                      include.lowest <span class="op">=</span> <span class="cn">TRUE</span>, right <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                      ordered_result <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">model_df</span>, by <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">".ratio"</span><span class="op">)</span>, </span>
<span>               names_to <span class="op">=</span> <span class="st">"statistic_type"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"statistic"</span>, </span>
<span>               values_drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>statistic_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"\\.ratio"</span>, <span class="st">""</span>, <span class="va">statistic_type</span><span class="op">)</span>,</span>
<span>         model_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">statistic_type</span> <span class="op">==</span> <span class="st">"W"</span>, </span>
<span>                             <span class="st">"Wilcoxon"</span>, <span class="va">model_type</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">group</span>, .after <span class="op">=</span> <span class="va">sex</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">signif</span>, .after <span class="op">=</span> <span class="va">p.value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"statistic"</span><span class="op">)</span>, .before <span class="op">=</span> <span class="va">p.value</span><span class="op">)</span></span></code></pre></div>
<p>See <code><a href="../reference/PRE_POST_STATS.html">?PRE_POST_STATS</a></code> for details.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.dataframe.html" class="external-link">print.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">PRE_POST_STATS</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      response age    sex group     emmean       SE  df   lower.CL   upper.CL</span></span>
<span><span class="co">#&gt; 1  NMR Weight  6M Female   SED  19.657280 1.763182 164  16.175816  23.138745</span></span>
<span><span class="co">#&gt; 2  NMR Weight  6M Female    4W   6.780870 1.079099 164   4.650152   8.911588</span></span>
<span><span class="co">#&gt; 3  NMR Weight  6M Female    8W   9.089814 1.323312 164   6.476888  11.702740</span></span>
<span><span class="co">#&gt; 4  NMR Weight 18M Female   SED  -2.537029 1.985229 164  -6.456932   1.382875</span></span>
<span><span class="co">#&gt; 5  NMR Weight 18M Female    4W  -4.033051 1.035377 164  -6.077438  -1.988663</span></span>
<span><span class="co">#&gt; 6  NMR Weight 18M Female    8W  -7.130273 1.762925 164 -10.611229  -3.649317</span></span>
<span><span class="co">#&gt; 7  NMR Weight  6M   Male   SED  18.134686 3.688867 164  10.850890  25.418483</span></span>
<span><span class="co">#&gt; 8  NMR Weight  6M   Male    4W  -1.287741 2.667299 164  -6.554416   3.978933</span></span>
<span><span class="co">#&gt; 9  NMR Weight  6M   Male    8W -15.924145 1.302963 164 -18.496891 -13.351399</span></span>
<span><span class="co">#&gt; 10 NMR Weight 18M   Male   SED -19.437882 2.902355 164 -25.168683 -13.707081</span></span>
<span><span class="co">#&gt;    statistic_type   statistic      p.value signif estimate  n model_type</span></span>
<span><span class="co">#&gt; 1               t  11.1487514 1.530334e-20    ***       NA NA         lm</span></span>
<span><span class="co">#&gt; 2               t   6.2838259 4.295441e-08    ***       NA NA         lm</span></span>
<span><span class="co">#&gt; 3               t   6.8689855 2.168921e-09    ***       NA NA         lm</span></span>
<span><span class="co">#&gt; 4               t  -1.2779525 2.030720e-01              NA NA         lm</span></span>
<span><span class="co">#&gt; 5               t  -3.8952484 1.283240e-03     **       NA NA         lm</span></span>
<span><span class="co">#&gt; 6               t  -4.0445703 8.856973e-04    ***       NA NA         lm</span></span>
<span><span class="co">#&gt; 7               t   4.9160579 2.127072e-05    ***       NA NA         lm</span></span>
<span><span class="co">#&gt; 8               t  -0.4827884 1.000000e+00              NA NA         lm</span></span>
<span><span class="co">#&gt; 9               t -12.2214860 1.406986e-23    ***       NA NA         lm</span></span>
<span><span class="co">#&gt; 10              t  -6.6972783 2.905306e-09    ***       NA NA         lm</span></span>
<span><span class="co">#&gt;                                                                              formula</span></span>
<span><span class="co">#&gt; 1  I(post_weight - pre_weight) ~ age + sex + group + age:sex + age:group + sex:group</span></span>
<span><span class="co">#&gt; 2  I(post_weight - pre_weight) ~ age + sex + group + age:sex + age:group + sex:group</span></span>
<span><span class="co">#&gt; 3  I(post_weight - pre_weight) ~ age + sex + group + age:sex + age:group + sex:group</span></span>
<span><span class="co">#&gt; 4  I(post_weight - pre_weight) ~ age + sex + group + age:sex + age:group + sex:group</span></span>
<span><span class="co">#&gt; 5  I(post_weight - pre_weight) ~ age + sex + group + age:sex + age:group + sex:group</span></span>
<span><span class="co">#&gt; 6  I(post_weight - pre_weight) ~ age + sex + group + age:sex + age:group + sex:group</span></span>
<span><span class="co">#&gt; 7  I(post_weight - pre_weight) ~ age + sex + group + age:sex + age:group + sex:group</span></span>
<span><span class="co">#&gt; 8  I(post_weight - pre_weight) ~ age + sex + group + age:sex + age:group + sex:group</span></span>
<span><span class="co">#&gt; 9  I(post_weight - pre_weight) ~ age + sex + group + age:sex + age:group + sex:group</span></span>
<span><span class="co">#&gt; 10 I(post_weight - pre_weight) ~ age + sex + group + age:sex + age:group + sex:group</span></span>
<span><span class="co">#&gt;      family                    weights obs_removed</span></span>
<span><span class="co">#&gt; 1  gaussian reciprocal group variances        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2  gaussian reciprocal group variances        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3  gaussian reciprocal group variances        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4  gaussian reciprocal group variances        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5  gaussian reciprocal group variances        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6  gaussian reciprocal group variances        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 7  gaussian reciprocal group variances        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 8  gaussian reciprocal group variances        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 9  gaussian reciprocal group variances        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 10 gaussian reciprocal group variances        &lt;NA&gt;</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.2 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] rstatix_0.7.2                         </span></span>
<span><span class="co">#&gt;  [2] latex2exp_0.9.6                       </span></span>
<span><span class="co">#&gt;  [3] purrr_1.0.1                           </span></span>
<span><span class="co">#&gt;  [4] tidyr_1.3.0                           </span></span>
<span><span class="co">#&gt;  [5] tibble_3.2.1                          </span></span>
<span><span class="co">#&gt;  [6] emmeans_1.8.7                         </span></span>
<span><span class="co">#&gt;  [7] dplyr_1.1.2                           </span></span>
<span><span class="co">#&gt;  [8] MASS_7.3-60                           </span></span>
<span><span class="co">#&gt;  [9] ggplot2_3.4.2                         </span></span>
<span><span class="co">#&gt; [10] MotrpacRatTrainingPhysiologyData_0.1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gtable_0.3.3       beeswarm_0.4.0     xfun_0.39          bslib_0.5.0       </span></span>
<span><span class="co">#&gt;  [5] lattice_0.21-8     vctrs_0.6.3        tools_4.3.1        generics_0.1.3    </span></span>
<span><span class="co">#&gt;  [9] fansi_1.0.4        highr_0.10         pkgconfig_2.0.3    Matrix_1.6-0      </span></span>
<span><span class="co">#&gt; [13] desc_1.4.2         lifecycle_1.0.3    compiler_4.3.1     farver_2.1.1      </span></span>
<span><span class="co">#&gt; [17] stringr_1.5.0      textshaping_0.3.6  munsell_0.5.0      carData_3.0-5     </span></span>
<span><span class="co">#&gt; [21] vipor_0.4.5        htmltools_0.5.5    sass_0.4.6         yaml_2.3.7        </span></span>
<span><span class="co">#&gt; [25] pillar_1.9.0       pkgdown_2.0.7      car_3.1-2          ggpubr_0.6.0      </span></span>
<span><span class="co">#&gt; [29] jquerylib_0.1.4    cachem_1.0.8       abind_1.4-5        nlme_3.1-162      </span></span>
<span><span class="co">#&gt; [33] tidyselect_1.2.0   digest_0.6.33      mvtnorm_1.2-2      stringi_1.7.12    </span></span>
<span><span class="co">#&gt; [37] splines_4.3.1      labeling_0.4.2     rprojroot_2.0.3    fastmap_1.1.1     </span></span>
<span><span class="co">#&gt; [41] grid_4.3.1         colorspace_2.1-0   cli_3.6.1          magrittr_2.0.3    </span></span>
<span><span class="co">#&gt; [45] utf8_1.2.3         broom_1.0.5        withr_2.5.0        scales_1.2.1      </span></span>
<span><span class="co">#&gt; [49] backports_1.4.1    ggbeeswarm_0.7.2   estimability_1.4.1 rmarkdown_2.23    </span></span>
<span><span class="co">#&gt; [53] ggsignif_0.6.4     ragg_1.2.5         memoise_2.0.1      evaluate_0.21     </span></span>
<span><span class="co">#&gt; [57] knitr_1.43         mgcv_1.8-42        rlang_1.1.1        glue_1.6.2        </span></span>
<span><span class="co">#&gt; [61] jsonlite_1.8.7     R6_2.5.1           systemfonts_1.0.4  fs_1.6.2</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tyler J. Sagendorf.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
