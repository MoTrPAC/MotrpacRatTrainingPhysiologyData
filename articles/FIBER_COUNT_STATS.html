<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Statistical analysis of fiber counts by muscle and fiber type • MotrpacRatTrainingPhysiologyData</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Statistical analysis of fiber counts by muscle and fiber type">
<meta property="og:description" content="MotrpacRatTrainingPhysiologyData">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MotrpacRatTrainingPhysiologyData</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ANALYTES_STATS.html">Statistical analyses of plasma clinical analytes</a>
    </li>
    <li>
      <a href="../articles/BASELINE_STATS.html">Statistical analyses of baseline body composition and VO2max testing measures</a>
    </li>
    <li>
      <a href="../articles/FIBER_AREA_STATS.html">Statistical analysis of mean fiber area by muscle and fiber type</a>
    </li>
    <li>
      <a href="../articles/FIBER_COUNT_STATS.html">Statistical analysis of fiber counts by muscle and fiber type</a>
    </li>
    <li>
      <a href="../articles/MUSCLES_STATS.html">Statistical analyses of muscle-specific measures</a>
    </li>
    <li>
      <a href="../articles/PRE_POST_STATS.html">Statistical analyses of post- vs. pre-training body composition and VO2max testing measures</a>
    </li>
    <li>
      <a href="../articles/WEEKLY_BODY_MASS_STATS.html">Statistical analysis of weekly body mass</a>
    </li>
    <li>
      <a href="../articles/analyte_plots.html">Plots of plasma clinical analytes</a>
    </li>
    <li>
      <a href="../articles/baseline_plots.html">Plots of baseline measures</a>
    </li>
    <li>
      <a href="../articles/dissection_time_plots.html">Plots of tissue dissection times</a>
    </li>
    <li>
      <a href="../articles/fiber_count_plots.html">Plots of muscle fiber type percentages</a>
    </li>
    <li>
      <a href="../articles/fiber_type_plots.html">Plots of fiber area by muscle and fiber type</a>
    </li>
    <li>
      <a href="../articles/muscle_plots.html">Plots of muscle measures</a>
    </li>
    <li>
      <a href="../articles/pre_post_plots.html">Plots of post - pre differences</a>
    </li>
    <li>
      <a href="../articles/weekly_measures_plots.html">Plots of weekly body mass and blood lactate</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PNNL-Comp-Mass-Spec/MotrpacRatTrainingPhysiologyData/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Statistical analysis of fiber counts by muscle
and fiber type</h1>
                        <h4 data-toc-skip class="author">Tyler
Sagendorf</h4>
            
            <h4 data-toc-skip class="date">27 October, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/PNNL-Comp-Mass-Spec/MotrpacRatTrainingPhysiologyData/blob/HEAD/vignettes/FIBER_COUNT_STATS.Rmd" class="external-link"><code>vignettes/FIBER_COUNT_STATS.Rmd</code></a></small>
      <div class="hidden name"><code>FIBER_COUNT_STATS.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/PNNL-Comp-Mass-Spec/MotrpacRatTrainingPhysiologyData/" class="external-link">MotrpacRatTrainingPhysiologyData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stat.boogaart.de/compositions/" class="external-link">compositions</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/emmeans" class="external-link">emmeans</a></span><span class="op">)</span></span>
<span><span class="co"># base plot theme</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="compositional-data-analysis">Compositional Data Analysis<a class="anchor" aria-label="anchor" href="#compositional-data-analysis"></a>
</h2>
<p><span class="citation"><sup>[<a href="#ref-aitchison_compositional_1982" role="doc-biblioref">1</a>,<a href="#ref-boogaart_compositional_2013" role="doc-biblioref">2</a>]</sup></span></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">FIBER_TYPES</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># Relevel fiber types for ilr later</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">nest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">-</span><span class="va">muscle</span><span class="op">)</span>, .by <span class="op">=</span> <span class="va">muscle</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">deframe</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>.f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">xi</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">xi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="co"># total fiber count is only included for illustrative purposes. It is not</span></span>
<span>      <span class="co"># necessary</span></span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pid</span>, <span class="va">age</span>, <span class="va">sex</span>, <span class="va">group</span>, <span class="va">total_fiber_count</span><span class="op">)</span>,</span>
<span>                  names_from <span class="op">=</span> <span class="va">type</span>,</span>
<span>                  names_prefix <span class="op">=</span> <span class="st">"t"</span>,</span>
<span>                  values_from <span class="op">=</span> <span class="va">fiber_count</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu">`rownames&lt;-`</span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">pid</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="co"># x is a named list of data.frames - one per muscle</span></span>
<span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">x</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $LG</span></span>
<span><span class="co">#&gt;               pid age    sex group total_fiber_count tIIb tIIx tIIa  tI</span></span>
<span><span class="co">#&gt; 10043799 10043799  6M Female   SED              8356 4905 2165  613 673</span></span>
<span><span class="co">#&gt; 10044337 10044337  6M Female   SED              7016 3290 2375  776 575</span></span>
<span><span class="co">#&gt; 10044922 10044922  6M Female   SED              8217 4186 2238 1019 774</span></span>
<span><span class="co">#&gt; 10045813 10045813  6M Female   SED              7495 3883 1997  741 874</span></span>
<span><span class="co">#&gt; 10046038 10046038  6M Female   SED              7970 4212 2377  832 549</span></span>
<span><span class="co">#&gt; 10046380 10046380  6M Female   SED              6701 3993 1706  732 270</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $MG</span></span>
<span><span class="co">#&gt;               pid age    sex group total_fiber_count tIIb tIIx tIIa  tI</span></span>
<span><span class="co">#&gt; 10043799 10043799  6M Female   SED              5461 2613 1506  573 769</span></span>
<span><span class="co">#&gt; 10044337 10044337  6M Female   SED              5789 2767 1648  694 680</span></span>
<span><span class="co">#&gt; 10044922 10044922  6M Female   SED              5632 2442 1794  827 569</span></span>
<span><span class="co">#&gt; 10045813 10045813  6M Female   SED              5596 3046 1414  585 551</span></span>
<span><span class="co">#&gt; 10046038 10046038  6M Female   SED              5974 2558 2056  744 616</span></span>
<span><span class="co">#&gt; 10046380 10046380  6M Female   SED              7167 3627 2029  711 800</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $PL</span></span>
<span><span class="co">#&gt;               pid age    sex group total_fiber_count tIIb tIIx tIIa  tI</span></span>
<span><span class="co">#&gt; 10043799 10043799  6M Female   SED              1667  515  565  441 146</span></span>
<span><span class="co">#&gt; 10044337 10044337  6M Female   SED              1152  405  426  258  63</span></span>
<span><span class="co">#&gt; 10044922 10044922  6M Female   SED              2021  522  678  595 226</span></span>
<span><span class="co">#&gt; 10045813 10045813  6M Female   SED              2080  535  798  576 171</span></span>
<span><span class="co">#&gt; 10046038 10046038  6M Female   SED              2175  612  849  557 157</span></span>
<span><span class="co">#&gt; 10046380 10046380  6M Female   SED              2014  449  798  514 253</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $SOL</span></span>
<span><span class="co">#&gt;               pid age    sex group total_fiber_count tIIa   tI</span></span>
<span><span class="co">#&gt; 10043799 10043799  6M Female   SED              1954  100 1854</span></span>
<span><span class="co">#&gt; 10044337 10044337  6M Female   SED              1810  122 1688</span></span>
<span><span class="co">#&gt; 10044922 10044922  6M Female   SED              1708  272 1436</span></span>
<span><span class="co">#&gt; 10045813 10045813  6M Female   SED              1810  192 1618</span></span>
<span><span class="co">#&gt; 10046038 10046038  6M Female   SED              1699   89 1610</span></span>
<span><span class="co">#&gt; 10046380 10046380  6M Female   SED              1849  132 1717</span></span></code></pre></div>
<p>We will look at the first 6 rows of the fiber count matrix for each
muscle. The fiber counts are elements of the positive orthant <span class="math inline">\(\mathbb{P}^4\)</span> (LG, MG, PL) or <span class="math inline">\(\mathbb{P}^2\)</span> (SOL). The orthant is “the
analogue in n-dimensional Euclidean space of a quadrant in the plane or
an octant in three dimensions. In two dimensions, there are four
orthants (called quadrants)” (Wikipedia - Orthant).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">x</span>, .f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">yi</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">yi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"tI"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">head</span><span class="op">)</span></span>
<span><span class="co">#&gt; $LG</span></span>
<span><span class="co">#&gt;          tIIb tIIx tIIa  tI</span></span>
<span><span class="co">#&gt; 10043799 4905 2165  613 673</span></span>
<span><span class="co">#&gt; 10044337 3290 2375  776 575</span></span>
<span><span class="co">#&gt; 10044922 4186 2238 1019 774</span></span>
<span><span class="co">#&gt; 10045813 3883 1997  741 874</span></span>
<span><span class="co">#&gt; 10046038 4212 2377  832 549</span></span>
<span><span class="co">#&gt; 10046380 3993 1706  732 270</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $MG</span></span>
<span><span class="co">#&gt;          tIIb tIIx tIIa  tI</span></span>
<span><span class="co">#&gt; 10043799 2613 1506  573 769</span></span>
<span><span class="co">#&gt; 10044337 2767 1648  694 680</span></span>
<span><span class="co">#&gt; 10044922 2442 1794  827 569</span></span>
<span><span class="co">#&gt; 10045813 3046 1414  585 551</span></span>
<span><span class="co">#&gt; 10046038 2558 2056  744 616</span></span>
<span><span class="co">#&gt; 10046380 3627 2029  711 800</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $PL</span></span>
<span><span class="co">#&gt;          tIIb tIIx tIIa  tI</span></span>
<span><span class="co">#&gt; 10043799  515  565  441 146</span></span>
<span><span class="co">#&gt; 10044337  405  426  258  63</span></span>
<span><span class="co">#&gt; 10044922  522  678  595 226</span></span>
<span><span class="co">#&gt; 10045813  535  798  576 171</span></span>
<span><span class="co">#&gt; 10046038  612  849  557 157</span></span>
<span><span class="co">#&gt; 10046380  449  798  514 253</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $SOL</span></span>
<span><span class="co">#&gt;          tIIa   tI</span></span>
<span><span class="co">#&gt; 10043799  100 1854</span></span>
<span><span class="co">#&gt; 10044337  122 1688</span></span>
<span><span class="co">#&gt; 10044922  272 1436</span></span>
<span><span class="co">#&gt; 10045813  192 1618</span></span>
<span><span class="co">#&gt; 10046038   89 1610</span></span>
<span><span class="co">#&gt; 10046380  132 1717</span></span></code></pre></div>
<p>If we close the compositions (scale the fiber counts in each row so
they sum to 1, rather than their total fiber count), we end up with
fiber type proportions. These are elements of the positive simplex <span class="math inline">\(\mathbb{S}^4\)</span> (LG, MG, PL) or <span class="math inline">\(\mathbb{S}^2\)</span> (SOL). Note that this
closure operation is not required by the transformation in the next code
chunk. These proportions are just for investigative purposes. We will
use the <code><a href="https://rdrr.io/pkg/compositions/man/clo.html" class="external-link">compositions::clo</a></code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Y_clo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">clo</span><span class="op">)</span> <span class="co"># close the compositions (convert to proportions)</span></span>
<span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">Y_clo</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $LG</span></span>
<span><span class="co">#&gt;           tIIb  tIIx  tIIa    tI</span></span>
<span><span class="co">#&gt; 10043799 0.587 0.259 0.073 0.081</span></span>
<span><span class="co">#&gt; 10044337 0.469 0.339 0.111 0.082</span></span>
<span><span class="co">#&gt; 10044922 0.509 0.272 0.124 0.094</span></span>
<span><span class="co">#&gt; 10045813 0.518 0.266 0.099 0.117</span></span>
<span><span class="co">#&gt; 10046038 0.528 0.298 0.104 0.069</span></span>
<span><span class="co">#&gt; 10046380 0.596 0.255 0.109 0.040</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $MG</span></span>
<span><span class="co">#&gt;           tIIb  tIIx  tIIa    tI</span></span>
<span><span class="co">#&gt; 10043799 0.478 0.276 0.105 0.141</span></span>
<span><span class="co">#&gt; 10044337 0.478 0.285 0.120 0.117</span></span>
<span><span class="co">#&gt; 10044922 0.434 0.319 0.147 0.101</span></span>
<span><span class="co">#&gt; 10045813 0.544 0.253 0.105 0.098</span></span>
<span><span class="co">#&gt; 10046038 0.428 0.344 0.125 0.103</span></span>
<span><span class="co">#&gt; 10046380 0.506 0.283 0.099 0.112</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $PL</span></span>
<span><span class="co">#&gt;           tIIb  tIIx  tIIa    tI</span></span>
<span><span class="co">#&gt; 10043799 0.309 0.339 0.265 0.088</span></span>
<span><span class="co">#&gt; 10044337 0.352 0.370 0.224 0.055</span></span>
<span><span class="co">#&gt; 10044922 0.258 0.335 0.294 0.112</span></span>
<span><span class="co">#&gt; 10045813 0.257 0.384 0.277 0.082</span></span>
<span><span class="co">#&gt; 10046038 0.281 0.390 0.256 0.072</span></span>
<span><span class="co">#&gt; 10046380 0.223 0.396 0.255 0.126</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $SOL</span></span>
<span><span class="co">#&gt;           tIIa    tI</span></span>
<span><span class="co">#&gt; 10043799 0.051 0.949</span></span>
<span><span class="co">#&gt; 10044337 0.067 0.933</span></span>
<span><span class="co">#&gt; 10044922 0.159 0.841</span></span>
<span><span class="co">#&gt; 10045813 0.106 0.894</span></span>
<span><span class="co">#&gt; 10046038 0.052 0.948</span></span>
<span><span class="co">#&gt; 10046380 0.071 0.929</span></span></code></pre></div>
<p>Now, we use the <code><a href="https://rdrr.io/pkg/compositions/man/ilr.html" class="external-link">compositions::ilr</a></code> function to perform
the isometric log-ratio (ilr) transformation and convert the proportions
to elements in <span class="math inline">\(\mathbb{R}^3\)</span> (LG,
MG, PL) or <span class="math inline">\(\mathbb{R}\)</span> (SOL)
according to the sequential binary partition (SBP) {I ||| IIa || IIx |
IIb}. That is, we can represent the data in 3-dimensional real space or
as values on the real number line. These coordinates are called
balances, which are defined as “the natural logarithm of the ratio of
geometric means of the parts in each group, normalised by a coefficient
to guarantee unit length of the vectors of the basis”<span class="citation"><sup>[<a href="#ref-coda_dendro_2016" role="doc-biblioref">3</a>]</sup></span>.</p>
<p>The following balances are generated</p>
<ul>
<li>
<span class="math inline">\(b1 = \frac{1}{\sqrt{2}} log \left(
\frac{I}{g(IIa, IIx, IIb)} \right)\)</span> or <span class="math inline">\(b1 = log \left( \frac{I}{IIa} \right)\)</span>
(SOL)</li>
<li><span class="math inline">\(b2 = \sqrt{\frac{2}{3}} log \left(
\frac{IIa}{g(IIx, IIb)} \right)\)</span></li>
<li><span class="math inline">\(b3 = log \left( \frac{IIx}{IIb}
\right)\)</span></li>
</ul>
<p>where <span class="math inline">\(g(\cdot)\)</span> is the geometric
mean (the <span class="math inline">\(n\)</span>th root of the product
of <span class="math inline">\(n\)</span> values). This is also referred
to as the “center” of the group of fiber types.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Y_ilr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">Y_clo</span>, <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Reverse the columns of the basis V to create the above SBPs</span></span>
<span>  <span class="va">V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/compositions/man/ilrBase.html" class="external-link">ilrBase</a></span><span class="op">(</span>D <span class="op">=</span> <span class="va">nc</span><span class="op">)</span><span class="op">[</span>, <span class="op">(</span><span class="va">nc</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">y_ilr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/compositions/man/ilr.html" class="external-link">ilr</a></span><span class="op">(</span><span class="va">y</span>, V <span class="op">=</span> <span class="va">V</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Remove the "rmult" class, or rstandard will not work for SOL</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">y_ilr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  </span>
<span>  <span class="va">y_ilr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">y_ilr</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">y_ilr</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co"># List of matrices containing ilr-transformed coordinates</span></span>
<span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">Y_ilr</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $LG</span></span>
<span><span class="co">#&gt;            [,1]   [,2]   [,3]</span></span>
<span><span class="co">#&gt; 10043799 -0.884 -1.364 -0.578</span></span>
<span><span class="co">#&gt; 10044337 -1.000 -1.046 -0.230</span></span>
<span><span class="co">#&gt; 10044922 -0.873 -0.898 -0.443</span></span>
<span><span class="co">#&gt; 10045813 -0.621 -1.081 -0.470</span></span>
<span><span class="co">#&gt; 10046038 -1.131 -1.091 -0.405</span></span>
<span><span class="co">#&gt; 10046380 -1.598 -1.038 -0.601</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $MG</span></span>
<span><span class="co">#&gt;            [,1]   [,2]   [,3]</span></span>
<span><span class="co">#&gt; 10043799 -0.462 -1.014 -0.390</span></span>
<span><span class="co">#&gt; 10044337 -0.667 -0.918 -0.366</span></span>
<span><span class="co">#&gt; 10044922 -0.860 -0.758 -0.218</span></span>
<span><span class="co">#&gt; 10045813 -0.783 -1.034 -0.543</span></span>
<span><span class="co">#&gt; 10046038 -0.813 -0.919 -0.154</span></span>
<span><span class="co">#&gt; 10046380 -0.671 -1.093 -0.411</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $PL</span></span>
<span><span class="co">#&gt;            [,1]   [,2]  [,3]</span></span>
<span><span class="co">#&gt; 10043799 -1.074 -0.164 0.066</span></span>
<span><span class="co">#&gt; 10044337 -1.496 -0.389 0.036</span></span>
<span><span class="co">#&gt; 10044922 -0.838  0.000 0.185</span></span>
<span><span class="co">#&gt; 10045813 -1.125 -0.103 0.283</span></span>
<span><span class="co">#&gt; 10046038 -1.246 -0.211 0.231</span></span>
<span><span class="co">#&gt; 10046380 -0.702 -0.124 0.407</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $SOL</span></span>
<span><span class="co">#&gt;           [,1]</span></span>
<span><span class="co">#&gt; 10043799 2.065</span></span>
<span><span class="co">#&gt; 10044337 1.858</span></span>
<span><span class="co">#&gt; 10044922 1.176</span></span>
<span><span class="co">#&gt; 10045813 1.507</span></span>
<span><span class="co">#&gt; 10046038 2.047</span></span>
<span><span class="co">#&gt; 10046380 1.814</span></span></code></pre></div>
<p>Now that we have multivariate Normal data, we can use multivariate
multiple regression. Here, each response is a column of the matrices
shown above. We will include categorical predictors age, sex, group, and
their interactions to start.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multivariate multiple regression models for each muscle</span></span>
<span><span class="va">fit.count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">x</span>, .y <span class="op">=</span> <span class="va">Y_ilr</span>, .f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">age</span> <span class="op">*</span> <span class="va">sex</span> <span class="op">*</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co"># map(fit.count, summary) # lm model summary for each ilr column and muscle</span></span></code></pre></div>
<p>For each model, we have measurements from 48 animals (6 biological
replicates per group). We lose 1 degree of freedom to estimate the
intercept (mean of SED 6M Female group), 3 degrees of freedom to
estimate each of the main effects, another 3 to estimate the 2-way
interactions, and 1 to estimate the 3-way interaction. Therefore, we
have 48 - 8 = 40 residual degrees of freedom.</p>
<p>We will check the model diagnostic plots. First, we will check for
homoscedasticity.</p>
<p>We will first look at boxplots of the standardized residuals to check
for Normality of the residuals for each response (fiber type). We are
using an <code>rstandard.mlm</code> method from <a href="https://stackoverflow.com/a/39768104" class="external-link uri">https://stackoverflow.com/a/39768104</a> included in this
package to calculate the standardized residuals.</p>
<p>Since I prefer the <code>ggplot2</code> package to base plotting, we
will transform the data to a longer format and then stack the data for
all four muscles.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Standardized residuals and fitted values</span></span>
<span><span class="va">resid_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">fit.count</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">rstandard.mlm</span><span class="op">)</span></span>
<span><span class="va">fitted_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">fit.count</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">fitted</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prepare data for plotting</span></span>
<span><span class="va">plot_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"resid"</span> <span class="op">=</span> <span class="va">resid_list</span>,</span>
<span>                <span class="st">"fitted"</span> <span class="op">=</span> <span class="va">fitted_list</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_transpose.html" class="external-link">list_transpose</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>.f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, .f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">name_i</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">.x</span><span class="op">[[</span><span class="va">name_i</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="st">"pid"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">pid</span>,</span>
<span>                     names_to <span class="op">=</span> <span class="st">"balance"</span>,</span>
<span>                     values_to <span class="op">=</span> <span class="va">name_i</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html" class="external-link">reduce</a></span><span class="op">(</span>.f <span class="op">=</span> <span class="va">left_join</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pid"</span>, <span class="st">"balance"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fitted</span>, <span class="va">resid</span><span class="op">)</span>, </span>
<span>                    .f <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">enframe</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"muscle"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>balance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="st">"b"</span>, <span class="va">balance</span><span class="op">)</span>,</span>
<span>         balance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="va">balance</span><span class="op">)</span>, <span class="st">"b1"</span>, <span class="va">balance</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot residuals vs. fitted for each muscle and fiber type</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fitted</span>, y <span class="op">=</span> <span class="va">resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>              method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>degree <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>              se <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Empirical rule: ~99.7% of data should be within 3 SD of the mean</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="op">+</span><span class="fl">3</span><span class="op">)</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">muscle</span> <span class="op">+</span> <span class="va">balance</span>, scales <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Fitted Values"</span>, y <span class="op">=</span> <span class="st">"Standardized Residuals"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Residuals vs. Fitted"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">1.6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="FIBER_COUNT_STATS_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>There is an outlier in the MG <span class="math inline">\(b1\)</span>
panel, and the MG <span class="math inline">\(b3\)</span> panel seems to
display non-constant variance of the residuals. We will check the
scale-location plots.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot scale vs. location plot for each muscle and fiber type</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fitted</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>              method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>degree <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>              se <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">muscle</span> <span class="op">+</span> <span class="va">balance</span>, scales <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Fitted"</span>, y <span class="op">=</span> <span class="st">"sqrt(|Standardized Residuals|)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Scale-Location"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">5e-3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">rel</a></span><span class="op">(</span><span class="fl">1.6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>There is increasing variance in the <span class="math inline">\(b3\)</span> panels of the MG and PL. Keep in mind
that there are only 6 samples per group.</p>
<p>We will check the Normality of the residuals with Q-Q plots.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html" class="external-link">geom_qq</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html" class="external-link">geom_qq_line</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fl">2</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">muscle</span> <span class="op">+</span> <span class="va">balance</span>, scales <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Theoretical Quantiles"</span>, y <span class="op">=</span> <span class="st">"Sample Quantiles"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Normal Q-Q Plot"</span><span class="op">)</span></span></code></pre></div>
<p>There are a few outliers, though they should not affect the results
too much. We will continue with hypothesis testing.</p>
</div>
<div class="section level2">
<h2 id="hypothesis-testing">Hypothesis Testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Estimated marginal means</span></span>
<span><span class="va">FIBER_COUNT_EMM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">fit.count</span>, <span class="kw">function</span><span class="op">(</span><span class="va">mod_i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">by</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"sex"</span><span class="op">)</span></span>
<span>  <span class="va">mult.name</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="st">"mlm"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">mod_i</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mult.name</span> <span class="op">&lt;-</span> <span class="st">"balance"</span></span>
<span>    <span class="va">by</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">by</span>, <span class="va">mult.name</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html" class="external-link">emmeans</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">mod_i</span>, specs <span class="op">=</span> <span class="st">"group"</span>, by <span class="op">=</span> <span class="va">by</span>, </span>
<span>          mult.name <span class="op">=</span> <span class="va">mult.name</span>, infer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>The values in the <code>emmean</code> column are the estimated
marginal means of the ilr coordinates (balances) for each sequential
binary partition (SBP):</p>
<ul>
<li>
<span class="math inline">\(b1\)</span>: <span class="math inline">\(\frac{1}{\sqrt2} log \left( \frac{I}{g(IIa, IIx,
IIb)} \right)\)</span> or <span class="math inline">\(\frac{1}{\sqrt2}
log \left( \frac{I}{IIa} \right)\)</span> (SOL)</li>
<li>
<span class="math inline">\(b2\)</span>: <span class="math inline">\(\sqrt{\frac{2}{3}} log \left( \frac{IIa}{g(IIx,
IIb)} \right)\)</span>
</li>
<li>
<span class="math inline">\(b3\)</span>: <span class="math inline">\(log \left( \frac{IIx}{IIb} \right)\)</span>
</li>
</ul>
<p>The P-values are testing whether the means of the groups are
different from 0, which is not of interest, in this case. We want to
know if there are differences between the 8W and SED groups.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_df</span> <span class="op">&lt;-</span> <span class="va">fit.count</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_chr</a></span><span class="op">(</span>.f <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="va">.x</span><span class="op">[[</span><span class="st">"call"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">enframe</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"muscle"</span>, value <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"(?&lt;=[\\s])\\s*|^\\s+|\\s+$"</span>, <span class="st">""</span>, <span class="va">model</span>, perl <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>         model_type <span class="op">=</span> <span class="st">"mlm"</span>,</span>
<span>         formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">".*formula = ([^,]+),.*"</span>, <span class="st">"\\1"</span>, <span class="va">model</span><span class="op">)</span>,</span>
<span>         formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="st">"ilr(cbind(tI, tIIa, tIIx, tIIb))"</span>, <span class="va">formula</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FIBER_COUNT_MVT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">FIBER_COUNT_EMM</span>, <span class="kw">function</span><span class="op">(</span><span class="va">emm_i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="st">"balance"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">emm_i</span>, <span class="st">"grid"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/mvcontrast.html" class="external-link">mvcontrast</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">emm_i</span>, method <span class="op">=</span> <span class="st">"trt.vs.ctrl"</span>, </span>
<span>                      mult.name <span class="op">=</span> <span class="st">"balance"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/contrast.html" class="external-link">contrast</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">emm_i</span>, method <span class="op">=</span> <span class="st">"trt.vs.ctrl"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">enframe</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"muscle"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p.value</span>, method <span class="op">=</span> <span class="st">"holm"</span><span class="op">)</span>,</span>
<span>         signif <span class="op">=</span> <span class="va">p.adj</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">T.square</span>, <span class="va">estimate</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"estimate_type"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"estimate"</span>, </span>
<span>               values_drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">".ratio"</span><span class="op">)</span>, </span>
<span>               names_to <span class="op">=</span> <span class="st">"statistic_type"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"statistic"</span>, </span>
<span>               values_drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">df2</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"df2"</span>,</span>
<span>               values_drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>statistic_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"\\.ratio"</span>, <span class="st">""</span>, <span class="va">statistic_type</span><span class="op">)</span>,</span>
<span>         estimate_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">estimate_type</span> <span class="op">==</span> <span class="st">"estimate"</span>, </span>
<span>                                <span class="st">"difference of means"</span>, <span class="va">estimate_type</span><span class="op">)</span>,</span>
<span>         response <span class="op">=</span> <span class="st">"Fiber Count"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">model_df</span>, by <span class="op">=</span> <span class="st">"muscle"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">response</span>, <span class="va">age</span>, <span class="va">sex</span>, <span class="va">muscle</span>, <span class="va">contrast</span>, <span class="va">estimate_type</span>, <span class="va">estimate</span>, </span>
<span>                <span class="va">SE</span>, <span class="va">statistic_type</span>, <span class="va">statistic</span>, <span class="va">df1</span>, <span class="va">df2</span>, <span class="va">p.value</span>, <span class="va">p.adj</span>,</span>
<span>                <span class="va">signif</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>muscle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">muscle</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LG"</span>, <span class="st">"MG"</span>, <span class="st">"PL"</span>, <span class="st">"SOL"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">muscle</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>We will proceed with specific comparisons of the subcompositions.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Trained vs. SED comparisons by age, sex, muscle, and fiber type</span></span>
<span><span class="va">FIBER_COUNT_STATS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">FIBER_COUNT_EMM</span>, <span class="kw">function</span><span class="op">(</span><span class="va">emm_i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/contrast.html" class="external-link">contrast</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">emm_i</span>, method <span class="op">=</span> <span class="st">"trt.vs.ctrl"</span>, infer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">enframe</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"muscle"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">muscle</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p.value</span>, method <span class="op">=</span> <span class="st">"holm"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">estimate</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"estimate_type"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"estimate"</span>, </span>
<span>               values_drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">".ratio"</span><span class="op">)</span>, </span>
<span>               names_to <span class="op">=</span> <span class="st">"statistic_type"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"statistic"</span>, </span>
<span>               values_drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>statistic_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"\\.ratio"</span>, <span class="st">""</span>, <span class="va">statistic_type</span><span class="op">)</span>,</span>
<span>         estimate_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">estimate_type</span> <span class="op">==</span> <span class="st">"estimate"</span>, </span>
<span>                                <span class="st">"difference of means"</span>, <span class="va">estimate_type</span><span class="op">)</span>,</span>
<span>         signif <span class="op">=</span> <span class="va">p.adj</span> <span class="op">&lt;</span> <span class="fl">0.05</span>,</span>
<span>         muscle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">muscle</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LG"</span>, <span class="st">"MG"</span>, <span class="st">"PL"</span>, <span class="st">"SOL"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         response <span class="op">=</span> <span class="st">"Fiber Count"</span>,</span>
<span>         balance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">balance</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">balance</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">model_df</span>, by <span class="op">=</span> <span class="st">"muscle"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">response</span>, <span class="va">age</span>, <span class="va">sex</span>, <span class="va">muscle</span>, <span class="va">balance</span>, <span class="va">contrast</span>, <span class="va">estimate_type</span>,</span>
<span>                <span class="va">estimate</span>, <span class="va">SE</span>, <span class="va">lower.CL</span>, <span class="va">upper.CL</span>, <span class="va">statistic_type</span>, <span class="va">statistic</span>, <span class="va">df</span>,</span>
<span>                <span class="va">p.value</span>, <span class="va">p.adj</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>muscle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">muscle</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LG"</span>, <span class="st">"MG"</span>, <span class="st">"PL"</span>, <span class="st">"SOL"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">sex</span>, <span class="va">muscle</span>, <span class="va">balance</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] emmeans_1.8.9                         </span></span>
<span><span class="co">#&gt; [2] ggplot2_3.4.4                         </span></span>
<span><span class="co">#&gt; [3] tibble_3.2.1                          </span></span>
<span><span class="co">#&gt; [4] purrr_1.0.2                           </span></span>
<span><span class="co">#&gt; [5] tidyr_1.3.0                           </span></span>
<span><span class="co">#&gt; [6] dplyr_1.1.3                           </span></span>
<span><span class="co">#&gt; [7] compositions_2.0-6                    </span></span>
<span><span class="co">#&gt; [8] MotrpacRatTrainingPhysiologyData_0.1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gtable_0.3.4       beeswarm_0.4.0     tensorA_0.36.2     xfun_0.40         </span></span>
<span><span class="co">#&gt;  [5] bslib_0.5.1        rstatix_0.7.2      lattice_0.21-8     vctrs_0.6.4       </span></span>
<span><span class="co">#&gt;  [9] tools_4.3.1        generics_0.1.3     fansi_1.0.5        DEoptimR_1.1-3    </span></span>
<span><span class="co">#&gt; [13] pkgconfig_2.0.3    Matrix_1.6-1.1     desc_1.4.2         lifecycle_1.0.3   </span></span>
<span><span class="co">#&gt; [17] farver_2.1.1       compiler_4.3.1     stringr_1.5.0      textshaping_0.3.7 </span></span>
<span><span class="co">#&gt; [21] munsell_0.5.0      carData_3.0-5      vipor_0.4.5        htmltools_0.5.6.1 </span></span>
<span><span class="co">#&gt; [25] sass_0.4.7         yaml_2.3.7         pillar_1.9.0       pkgdown_2.0.7     </span></span>
<span><span class="co">#&gt; [29] car_3.1-2          ggpubr_0.6.0       jquerylib_0.1.4    MASS_7.3-60       </span></span>
<span><span class="co">#&gt; [33] cachem_1.0.8       abind_1.4-5        nlme_3.1-162       robustbase_0.99-0 </span></span>
<span><span class="co">#&gt; [37] tidyselect_1.2.0   digest_0.6.33      mvtnorm_1.2-3      stringi_1.7.12    </span></span>
<span><span class="co">#&gt; [41] labeling_0.4.3     splines_4.3.1      rprojroot_2.0.3    fastmap_1.1.1     </span></span>
<span><span class="co">#&gt; [45] grid_4.3.1         colorspace_2.1-0   cli_3.6.1          magrittr_2.0.3    </span></span>
<span><span class="co">#&gt; [49] utf8_1.2.4         broom_1.0.5        withr_2.5.1        scales_1.2.1      </span></span>
<span><span class="co">#&gt; [53] backports_1.4.1    ggbeeswarm_0.7.2   estimability_1.4.1 rmarkdown_2.25    </span></span>
<span><span class="co">#&gt; [57] ggsignif_0.6.4     ragg_1.2.6         memoise_2.0.1      evaluate_0.22     </span></span>
<span><span class="co">#&gt; [61] knitr_1.44         mgcv_1.8-42        rlang_1.1.1        Rcpp_1.0.11       </span></span>
<span><span class="co">#&gt; [65] glue_1.6.2         bayesm_3.1-6       jsonlite_1.8.7     R6_2.5.1          </span></span>
<span><span class="co">#&gt; [69] systemfonts_1.0.5  fs_1.6.3</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-aitchison_compositional_1982" class="csl-entry">
1. Aitchison, J. (1982). The statistical analysis of compositional data.
<em>Journal of the Royal Statistical Society. Series B
(Methodological)</em>, <em>44</em>(2), 139–177. <a href="http://www.jstor.org/stable/2345821" class="external-link">http://www.jstor.org/stable/2345821</a>
</div>
<div id="ref-boogaart_compositional_2013" class="csl-entry">
2. Boogaart, K. G. van den, &amp; Tolosana-Delgado, R. (2013).
<em>Analyzing compositional data with r</em>. Springer Berlin
Heidelberg. <a href="https://doi.org/10.1007/978-3-642-36809-7" class="external-link">https://doi.org/10.1007/978-3-642-36809-7</a>
</div>
<div id="ref-coda_dendro_2016" class="csl-entry">
3. Pawlowsky-Glahn, V., &amp; Egozcue, J. J. (2016). Exploring
compositional data with the <span>CoDa-Dendrogram</span>. <em>Austrian
Journal of Statistics</em>, <em>40</em>(1&amp;2), 103–113.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tyler J. Sagendorf.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
